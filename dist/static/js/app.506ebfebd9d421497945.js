webpackJsonp([0],{"+OZI":function(e,t){},"3l8V":function(e,t){},"7gnl":function(e,t){},AD22:function(e,t){},BhWB:function(e,t){},Bjlk:function(e,t){},F81L:function(e,t){},G298:function(e,t){},GFzu:function(e,t){},Gt7D:function(e,t){},LROG:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),r={data:function(){return{userName:"TestUser",menuItem:["Профиль","Оплата","Справка"],isEnableDropdown:!1}},methods:{toggleDropdown(){this.isEnableDropdown=!this.isEnableDropdown}},computed:{loggedIn(){return this.$store.getters.loggedIn}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"navbar"},[s("router-link",{staticClass:"navbar-logo",attrs:{to:{name:"Buildings"}}},[s("img",{attrs:{src:"/static/img/footer_logo.svg"}})]),e._v(" "),s("div",{staticClass:"navbar-notice"},[e._v("1")]),e._v(" "),s("div",{staticClass:"navbar-profile"},[s("div",{staticClass:"profile-name",on:{click:e.toggleDropdown}},[e._v(e._s(e.userName)+"\n    ")]),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.isEnableDropdown?s("div",{staticClass:"profile-menu",on:{mouseleave:e.toggleDropdown}},[e._l(e.menuItem,function(t,a){return s("a",{key:a,staticClass:"menu-item",attrs:{href:"#"}},[e._v(e._s(t))])}),e._v(" "),s("router-link",{staticClass:"menu-item",attrs:{to:{name:"Logout"}}},[e._v("Выход")])],2):e._e()])],1)],1)},staticRenderFns:[]};var o={name:"App",components:{Navbar:s("VU/8")(r,i,!1,function(e){s("gw1M")},"data-v-019e1aa4",null).exports},computed:{isAuthenticated:function(){return this.$store.getters.loggedIn}}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[this.isAuthenticated?t("Navbar"):this._e(),this._v(" "),t("main",[t("router-view")],1)],1)},staticRenderFns:[]};var l=s("VU/8")(o,n,!1,function(e){s("SlCM")},null,null).exports,c=s("/ocq"),d={name:"CommonMethods",methods:{showError(e,t){if(void 0!==e.response){const s=e.response.data;if(s.single_error)t.singleErrorMessage=s.message;else for(let e in s){let a=s[e][0];t[e].validationClass="error",t[e].validationText=a}}else t.singleErrorMessage="Что-то пошло не так."},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.singleErrorMessage=""},showAlert(e,t,s){if("undefined"!==e.response.status){const t=e.response.data;for(let e in t){let a=t[e];s.message=a}}else s.message="Что-то пошло не так.";s.alive=!0,setTimeout(function(){s.alive=!1},3e3)},resetData(){Object.assign(this.$data,this.$options.data())}}},u={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};var m=s("VU/8")(d,u,!1,function(e){s("ySvM")},"data-v-80bc1340",null).exports,_={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-column"},[t("div",{staticClass:"login-column__bg",staticStyle:{"background-image":"url(/static/img/city.png)"}}),this._v(" "),t("div",{staticClass:"login-column__text"},[t("div",{staticClass:"login-container"},[this._t("default")],2)])])},staticRenderFns:[]};var v=s("VU/8")({name:"AuthContainer"},_,!1,function(e){s("mIZk")},"data-v-825ea81e",null).exports,p={name:"ButtonDefault",props:{color:{type:String,default:function(){return"white"}},name:{type:String,require:!0},actionForClick:Function},methods:{methodFromParent(){this.actionForClick()}}},h={render:function(){var e=this.$createElement;return(this._self._c||e)("button",{staticClass:"button",attrs:{type:"button","button-color":this.color},on:{click:this.methodFromParent}},[this._v("\n  "+this._s(this.name)+"\n")])},staticRenderFns:[]};var f=s("VU/8")(p,h,!1,function(e){s("e5pe")},null,null).exports,g={name:"AuthRegister",data:()=>({companyName:"",firstName:"",lastName:"",middleName:"",email:"",phone:"",password:"",passwordConfirmation:"",errorsStack:[],isAgreeWithSavePersonalData:!1,send:!1}),components:{AuthContainer:v,ButtonDefault:f},mixins:[m],methods:{register(){if(this.password===this.passwordConfirmation){const e=JSON.stringify({company_name:this.companyName,first_name:this.firstName,last_name:this.lastName,middle_name:this.middleName,email:this.email,is_agree_with_save_personal_data:this.isAgreeWithSavePersonalData,phone:this.phone,password:this.password,password_confirmation:this.passwordConfirmation});this.$store.dispatch("registerUser",e).then(()=>{this.send=!0}).catch(e=>{this.errorsStack=e.response.data})}else this.errorsStack.password_confirmation="Пароли должны совпадать"}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("AuthContainer",[e.send?s("div",{staticClass:"login-reset"},[s("div",{staticClass:"login-reset__title"},[e._v("Отлично! Осталось подтвердить ваш email. На вашу почту отправлено письмо с\n      подтверждением.\n    ")]),e._v(" "),s("div",{staticClass:"login-reset__email"},[e._v(e._s(this.email))]),e._v(" "),s("div",{staticClass:"login-button"},[s("div",{staticClass:"login-button__register"},[s("div",{staticClass:"login-button__register_title"},[e._v("Есть учетная запись?")])]),e._v(" "),s("div",{staticClass:"login-button__register"},[s("router-link",{staticClass:"link",attrs:{to:"/login"}},[e._v("Авторизуйтесь здесь")])],1)])]):s("div",{staticClass:"login-form"},[s("div",{staticClass:"login-title"},[e._v("Регистрация пользователя")]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"company_name"}},[e._v("Компания:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.company_name?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.company_name[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.companyName,expression:"companyName"}],class:e.validationClass.company_name,attrs:{type:"text",id:"company_name"},domProps:{value:e.companyName},on:{click:e.clearError,input:function(t){t.target.composing||(e.companyName=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"last_name"}},[e._v("Фамилия:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.last_name?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.last_name[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],class:e.validationClass.last_name,attrs:{type:"text",id:"last_name"},domProps:{value:e.lastName},on:{click:e.clearError,input:function(t){t.target.composing||(e.lastName=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"first_name"}},[e._v("Имя:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.first_name?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.first_name[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],class:e.validationClass.first_name,attrs:{type:"text",id:"first_name"},domProps:{value:e.firstName},on:{click:e.clearError,input:function(t){t.target.composing||(e.firstName=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"middle_name"}},[e._v("Отчество:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.middle_name?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.middle_name[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.middleName,expression:"middleName"}],class:e.validationClass.middle_name,attrs:{type:"text",id:"middle_name"},domProps:{value:e.middleName},on:{click:e.clearError,input:function(t){t.target.composing||(e.middleName=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"email"}},[e._v("Email:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.email?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.email[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],class:e.validationClass.email,attrs:{type:"email",id:"email",required:""},domProps:{value:e.email},on:{click:e.clearError,input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"phone"}},[e._v("Телефон:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.phone?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.phone[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],class:e.validationClass.phone,attrs:{id:"phone",required:""},domProps:{value:e.phone},on:{click:e.clearError,input:function(t){t.target.composing||(e.phone=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"password"}},[e._v("Пароль:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.password?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.password[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:e.validationClass.password,attrs:{id:"password",required:""},domProps:{value:e.password},on:{click:e.clearError,input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"password_confirmation"}},[e._v("Повторить пароль:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.password_confirmation?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.password_confirmation[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordConfirmation,expression:"passwordConfirmation"}],class:e.validationClass.password_confirmation,attrs:{id:"password_confirmation",required:""},domProps:{value:e.passwordConfirmation},on:{click:e.clearError,input:function(t){t.target.composing||(e.passwordConfirmation=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("div"),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.isAgreeWithSavePersonalData,expression:"isAgreeWithSavePersonalData"}],class:e.validationClass.is_agree_with_save_personal_data,attrs:{type:"checkbox",id:"is_agree_with_save_personal_data"},domProps:{checked:Array.isArray(e.isAgreeWithSavePersonalData)?e._i(e.isAgreeWithSavePersonalData,null)>-1:e.isAgreeWithSavePersonalData},on:{click:e.clearError,change:function(t){var s=e.isAgreeWithSavePersonalData,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,null);a.checked?i<0&&(e.isAgreeWithSavePersonalData=s.concat([null])):i>-1&&(e.isAgreeWithSavePersonalData=s.slice(0,i).concat(s.slice(i+1)))}else e.isAgreeWithSavePersonalData=r}}}),e._v(" "),s("label",{attrs:{for:"is_agree_with_save_personal_data"}},[e._v("Я принимаю договор-оферту и даю согласие на обработку\n          персональных данных")])])]),e._v(" "),e.singleErrorMessage?s("div",{staticClass:"static-error"},[e._v("\n      "+e._s(e.singleErrorMessage)+"\n    ")]):e._e(),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Отправить",color:"green",actionForClick:e.register}})],1)])},staticRenderFns:[]};var C=s("VU/8")(g,b,!1,function(e){s("VvEV")},"data-v-30d424e7",null).exports,w={name:"AuthLogin",data:()=>({email:"",password:"",errorsStack:[]}),components:{AuthContainer:v,ButtonDefault:f},methods:{login(){this.$store.dispatch("retrieveAuthData",{email:this.email,password:this.password}).then(()=>{this.$router.push("/")}).catch(e=>{this.errorsStack=e.response.data})},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.$delete(this.errorsStack,"single_error")}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("AuthContainer",[s("div",{staticClass:"login-title"},[e._v("Личный кабинет")]),e._v(" "),s("form",{staticClass:"login-form",on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"email"}},[e._v("Email")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.email?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.email[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],class:e.validationClass.email,attrs:{type:"email",id:"email"},domProps:{value:e.email},on:{click:e.clearError,input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"password"}},[e._v("Пароль")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.password?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.password[0])+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:e.validationClass.password,attrs:{id:"password"},domProps:{value:e.password},on:{click:e.clearError,input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),e.singleErrorMessage?s("div",{staticClass:"login-alert"},[e._v("\n      "+e._s(e.singleErrorMessage)+"\n    ")]):e._e(),e._v(" "),s("div",{staticClass:"login-button"},[s("div",[s("ButtonDefault",{staticClass:"button-expand",attrs:{actionForClick:e.login,name:"Войти",color:"green"}})],1),e._v(" "),s("div",{staticClass:"login-button__register"},[s("div",{staticClass:"login-button__register_title"},[e._v("Ещё нет аккаунта?")]),e._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/register/"}},[e._v("Пройти простую регистрацию")])],1),e._v(" "),s("div",{staticClass:"login-button__reset"},[s("router-link",{staticClass:"link",attrs:{to:"/password/email/"}},[e._v("Восстановить пароль")])],1)])])])},staticRenderFns:[]};var S=s("VU/8")(w,y,!1,function(e){s("aF4X")},"data-v-4b82d815",null).exports,F={name:"BeatLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#2EC1B3"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data(){return{spinnerStyle:{backgroundColor:this.color,height:this.size,width:this.size,margin:this.margin,borderRadius:this.radius}}}},k={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"show",rawName:"v-show",value:this.loading,expression:"loading"}],staticClass:"v-spinner"},[t("div",{staticClass:"v-beat v-beat-odd",style:this.spinnerStyle}),t("div",{staticClass:"v-beat v-beat-even",style:this.spinnerStyle}),t("div",{staticClass:"v-beat v-beat-odd",style:this.spinnerStyle})])},staticRenderFns:[]};var I=s("VU/8")(F,k,!1,function(e){s("keWv")},null,null).exports,x={name:"AuthPasswordEmail",data:()=>({email:"",send:!1,sendingOut:!1,errorsStack:[]}),components:{AuthContainer:v,ButtonDefault:f,BeatLoader:I},methods:{sentEmailForResetPassword(){this.sendingOut=!0,this.$store.dispatch("writeItem",{url:"/password/email",fields:{email:this.email}}).then(()=>{this.send=!0,this.sendingOut=!1}).catch(e=>{this.errorsStack=e.response.data,this.sendingOut=!1})}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null}}},A={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("AuthContainer",[s("div",[e.send?s("div",{staticClass:"login-reset"},[s("div",{staticClass:"login-reset__title"},[e._v("Письмо с информацией для смены пароля отправлено на адрес:")]),e._v(" "),s("div",{staticClass:"login-reset__email"},[e._v(e._s(this.email))]),e._v(" "),s("div",{staticClass:"login-button"},[s("div",{staticClass:"login-button__register"},[s("div",{staticClass:"login-button__register_title"},[e._v("Вспомнили пароль?")])]),e._v(" "),s("div",{staticClass:"login-button__register"},[s("router-link",{staticClass:"link",attrs:{to:"/login"}},[e._v("Авторизуйтесь здесь")])],1)])]):s("div",[s("div",{staticClass:"login-title"},[e._v("Сброс пароля")]),e._v(" "),s("form",{on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"email"}},[e._v("Email")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.email?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.email[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],class:e.validationClass.email,attrs:{type:"email",id:"email"},domProps:{value:e.email},on:{click:e.clearError,input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),e.singleErrorMessage?s("div",{staticClass:"login-alert"},[e._v("\n          "+e._s(e.singleErrorMessage)+"\n        ")]):e._e(),e._v(" "),s("div",{staticClass:"login-button"},[s("div",[e.sendingOut?s("BeatLoader"):s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Восстановить",color:"green",actionForClick:e.sentEmailForResetPassword}})],1),e._v(" "),s("div",{staticClass:"login-button__register"},[s("div",{staticClass:"login-button__register_title"},[e._v("Вспомнили пароль?")]),e._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/login"}},[e._v("Авторизуйтесь здесь")])],1)])])])])])},staticRenderFns:[]};var E=s("VU/8")(x,A,!1,function(e){s("yL8Y")},"data-v-99cd9146",null).exports,M=s("mtWM"),N=s.n(M),D={name:"AuthPasswordReset",data:()=>({password:"",passwordConfirmation:"",send:!1,sendingOut:!1,errorsStack:[],singleErrorMessage:""}),components:{AuthContainer:v,ButtonDefault:f,BeatLoader:I},mixins:[m],methods:{resetPassword(){if(this.password===this.passwordConfirmation){var e=JSON.stringify({password:this.password,password_confirmation:this.passwordConfirmation,password_code:this.$route.params.password_code});N.a.post(this.$rootUrl+"/password/reset",e).then(e=>{const t={apiKey:e.data.api_key,companyHashId:e.data.company_hash_id};this.send=!0,this.$store.dispatch("storeLoginData",t).then(()=>{this.$router.push("/")}).catch(e=>{this.showError(e,this)})}).catch(e=>{this.showError(e,this)})}else this.singleErrorMessage="Пароли не совпадают"}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e}}},$={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("AuthContainer",[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"password"}},[e._v("Пароль")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.password?s("span",{staticClass:"form-group__alert"},[e._v("\n          "+e._s(e.errorsStack.password[0])+"\n        ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:e.validationClass.password,attrs:{type:"password",id:"password"},domProps:{value:e.password},on:{click:e.clearError,input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"password_confirmation"}},[e._v("Повторить пароль")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.password_confirmation?s("span",{staticClass:"form-group__alert"},[e._v("\n          "+e._s(e.errorsStack.password_confirmation[0])+"\n        ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordConfirmation,expression:"passwordConfirmation"}],class:e.validationClass.password_confirmation,attrs:{type:"password",id:"password_confirmation"},domProps:{value:e.passwordConfirmation},on:{click:e.clearError,input:function(t){t.target.composing||(e.passwordConfirmation=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),e.singleErrorMessage?s("div",{staticClass:"login-alert"},[e._v("\n    "+e._s(e.singleErrorMessage)+"\n  ")]):e._e(),e._v(" "),e.sendingOut?s("BeatLoader"):s("ButtonDefault",{attrs:{actionForClick:e.resetPassword,name:"Восстановить пароль",color:"green"}})],1)},staticRenderFns:[]};var B=s("VU/8")(D,$,!1,function(e){s("F81L")},"data-v-7d613cf1",null).exports,H={name:"AlertDefault",props:{message:{type:String,required:!0},alertType:{type:String,default:"warning"}},created(){const e=this;setTimeout(function(){e.$emit("alertDie")},3e3)}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{staticClass:"uk-alert",attrs:{name:"slide-fade",alertType:this.alertType}},[this.message?t("div",[this._v(this._s(this.message))]):this._e()])},staticRenderFns:[]};var O=s("VU/8")(H,P,!1,function(e){s("y+6z")},"data-v-6e865883",null).exports,T={name:"AuthLogout",components:{AlertDefault:O},data:()=>({alert:{alive:!1,type:"danger",message:""}}),mixins:[m],created(){this.$store.dispatch("destroyApiKey").then(()=>{this.$router.push("/")}).catch(e=>{const t=this.alert;500===e.response.status?this.alert.message="Что-то пошло не так.":this.alert.message=e.response.data.message,t.alive=!0,setTimeout(function(){t.alive=!1},3e3)})}},V={render:function(){var e=this.$createElement,t=this._self._c||e;return this.alert.alive?t("AlertDefault",{attrs:{message:this.alert.message,alertType:this.alert.type}}):this._e()},staticRenderFns:[]};var R=s("VU/8")(T,V,!1,function(e){s("LROG")},"data-v-10e85d9a",null).exports,U={components:{ButtonDefault:f},props:{imageSource:String,title:{type:String,required:!0},storeIndex:{type:Number,required:!0},city:String,buildingId:{type:String,required:!0},address:String,country:String,district:String,region:String,flats:Object},data:()=>({staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},isVisibleButtons:!1}),methods:{toggleEditButton(){this.isVisibleButtons=!this.isVisibleButtons},editBuilding(){this.$router.push({name:"BuildingProperties",params:{buildingStoreIndex:this.storeIndex,editMode:!0}})},removeBuilding(){this.$emit("activateAlertConfirm",this.buildingId)},redirectToCurrentBuildingMain(){this.$router.push({name:"BuildingMain",params:{buildingStoreIndex:this.storeIndex}})}},computed:{numberOfFlats(){let e=0;for(let t in this.flats)e+=this.flats[t];return e}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"buildings-item",on:{mouseover:e.toggleEditButton,mouseout:e.toggleEditButton}},[s("div",{staticClass:"item-image",on:{click:e.redirectToCurrentBuildingMain}},[s("img",{attrs:{src:"https://novostroy-a.akamaihd.net/regions/u/b/g/box_orig/5b03e4137288c.jpg",alt:""}})]),e._v(" "),s("div",{staticClass:"item-desc",on:{click:e.redirectToCurrentBuildingMain}},[s("div",[s("div",{staticClass:"desc-title"},[e._v(e._s(e.title))]),e._v(" "),e._m(0),e._v(" "),s("div",{staticClass:"desc-address"},[e._v(e._s(e.country)+", "+e._s(e.region)+", "+e._s(e.city)+", "+e._s(e.district))])]),e._v(" "),s("div",{staticClass:"desc-amount"},[e._m(1),e._v(" "),s("div",{staticClass:"desc-amount__count"},[e._v(e._s(e.numberOfFlats))])])]),e._v(" "),s("div",{staticClass:"item-list"},[e._l(e.flats,function(t,a){return s("div",{key:a,staticClass:"list-flat"},[s("div",{staticClass:"list-flat__type"},[e._v(e._s(e.staticFlatsSchemasTypes[a].alias))]),e._v(" "),s("div",{staticClass:"list-flat__desc"},[s("div",[e._v(e._s(e.staticFlatsSchemasTypes[a].title))]),e._v(" "),s("div",{staticClass:"list-flat__desc_price"},[e._v("от 1,25 млн.руб.")])]),e._v(" "),s("div",{staticClass:"list-flat__amount"},[e._v(e._s(t))])])}),e._v(" "),e.isVisibleButtons?s("div",{staticClass:"item-buttons"},[s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Редактировать",color:"green",actionForClick:e.editBuilding}}),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Удалить",color:"grey",actionForClick:e.removeBuilding}})],1):e._e()],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"desc-type"},[t("span",{staticClass:"desc-type__badge"},[this._v("Жилой комплекс")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"desc-amount__title"},[this._v("Осталось"),t("br"),this._v("квартир")])}]};var q=s("VU/8")(U,L,!1,function(e){s("pG3g")},"data-v-76bbfa34",null).exports,W={name:"AlertConfirm",props:{additionalMessage:String},methods:{agreeAction(){this.$emit("isAgree")},disagreeAction(){this.$emit("isDisagree")}}},j={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"alert-confirm"},[s("div",[e._v(e._s(e.additionalMessage))]),e._v(" "),s("div",[e._v("Вы уверены?")]),e._v(" "),s("div",[s("button",{on:{click:e.agreeAction}},[e._v("Да")]),e._v(" "),s("button",{on:{click:e.disagreeAction}},[e._v("Нет")])])])])},staticRenderFns:[]};var J=s("VU/8")(W,j,!1,function(e){s("yNAI")},"data-v-17c654cd",null).exports,G={name:"Buildings",data:()=>({buildings:[],alertMessage:"",selectedBuildingId:"",alertConfirm:{isActive:!1,additionalMessage:"Если вы удалите этот объект, то все данные будут отображаться не корректно"}}),components:{AlertDefault:O,AlertConfirm:J,BuildingsItem:q,ButtonDefault:f},created(){this.getBuildings()},methods:{getBuildings(){let e=this.$store.state.companyHashId;this.$store.dispatch("retrieveItem",{url:"/company/"+e+"/buildings",storageName:"buildings"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"buildings",fields:JSON.stringify(e.data)}),this.buildings=e.data}).catch(e=>{this.alertMessage="Не могу получить список домов. Обратитесь к администратору.",console.info(e.response)})},redirectToCreate(){this.$store.dispatch("destroyItemFromStore","currentBuildingStoreIndex"),this.$router.push({name:"BuildingProperties"})},removeBuilding(){this.$store.dispatch("removeItem",{url:"/buildings/"+this.selectedBuildingId}).then(()=>{this.alertMessage="Объект успешно удалён",this.getBuildings()}).catch(e=>{this.alertMessage="Не удалось удалить объект",console.info("Не удалось удалить объект. Вот почему: ",e.response.data)}),this.closeAlertConfirm()},activateAlertConfirm(e){this.selectedBuildingId=e,this.alertConfirm.isActive=!0},closeAlertConfirm(){this.alertConfirm.isActive=!1}}},K={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"buildings"},[e.alertMessage?s("AlertDefault",{attrs:{message:e.alertMessage},on:{alertDie:function(t){e.alertMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"buildings-create"},[s("div",{staticClass:"create"},[s("div",{staticClass:"create-title"},[e._v("Новый объект")]),e._v(" "),s("div",{staticClass:"create-button"},[s("ButtonDefault",{staticClass:"create-button__add button-expand",attrs:{name:"Добавить объект",color:"grey",actionForClick:e.redirectToCreate}}),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Создадим за вас",color:"green"}})],1),e._v(" "),e._m(0)]),e._v(" "),s("img",{staticClass:"create-image",attrs:{src:"/static/img/PersonalManager.jpg",alt:""}})]),e._v(" "),e.alertConfirm.isActive?s("AlertConfirm",{attrs:{additionalMessage:e.alertConfirm.additionalMessage},on:{isAgree:e.removeBuilding,isDisagree:e.closeAlertConfirm}}):e._e(),e._v(" "),e._l(e.buildings,function(t,a){return s("BuildingsItem",{key:t.building.id,attrs:{storeIndex:a,buildingId:t.building.hash_id,title:t.building.name,imageSource:t.building.images,city:t.building.city,address:t.building.address,country:t.building.country,district:t.building.district,region:t.building.region,flats:t.flats_by_type},on:{activateAlertConfirm:e.activateAlertConfirm}})})],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"create-desc"},[this._v("Доверьте создание объекта персональному "),t("span",[this._v("менеджеру")]),this._v(".")])}]};var Y=s("VU/8")(G,K,!1,function(e){s("YGWQ")},"data-v-567f2247",null).exports,X={components:{ButtonDefault:f},props:{houseId:{type:String},storeIndex:Number,numberOfFloors:Number,livingFloors:String,numberOfEntrance:Number,numberOfFlat:Number,streetName:String,number:String,title:String,finishing:String,flats:Array,stageDevelopment:String,startDevelopment:String,endDevelopment:String},data:()=>({imageSource:"/static/img/MilleniumFalcon.jpg",staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},isVisibleButtons:!1}),methods:{setHouseId(){this.$store.dispatch("setItemToStore",{fields:this.houseId,storageName:"currentHouseId"})},toggleEditButton(){this.isVisibleButtons=!this.isVisibleButtons},getFullHouse(){this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId,storageName:"properties"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"properties",fields:JSON.stringify(e.data)})}).catch(e=>{console.info("Не могу получить характеристики дома. Вот почему: ",e.response.data)})},redirectToEditHouse(){this.getFullHouse(),this.setHouseId(),this.$router.push({name:"HouseProperties",params:{houseStoreIndex:this.storeIndex,editMode:!0}})},redirectToCurrentHouseMain(){this.getFullHouse(),this.setHouseId(),this.$router.push({name:"HouseMainProperties",params:{houseStoreIndex:this.storeIndex}})},removeHouse(){console.info(this.houseId),this.$emit("activateAlertConfirm",this.houseId)}},computed:{flatsBalance(){let e=0;return this.flats.map(t=>{e+=Number(t.number_of)}),e}}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"buildings-item",on:{mouseover:e.toggleEditButton,mouseout:e.toggleEditButton}},[s("div",[s("div",{staticClass:"item-image",on:{click:e.redirectToCurrentHouseMain}},[s("img",{attrs:{alt:"",src:"https://spbhomes.ru/files/building/71/0/images/%D0%97%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_20Bak27_View01.1482496934.jpg.1920x1080r.jpg"}})]),e._v(" "),s("div",{staticClass:"item-desc",on:{click:e.redirectToCurrentHouseMain}},[s("div",[s("div",{staticClass:"desc-title"},[e._v(e._s(e.streetName)+","+e._s(e.number))]),e._v(" "),e._m(0),e._v(" "),s("div",{staticClass:"desc-address"},[e._v(e._s(e.streetName)+","+e._s(e.number))])]),e._v(" "),s("div",{staticClass:"desc-amount"},[e._m(1),e._v(" "),s("div",{staticClass:"desc-amount__count"},[e._v(e._s(e.flatsBalance))])])]),e._v(" "),s("div",{staticClass:"item-list"},[e._l(e.flats,function(t,a){return s("div",{key:a,staticClass:"list-flat"},[s("div",{staticClass:"list-flat__type"},[e._v(e._s(e.staticFlatsSchemasTypes[t.type].alias))]),e._v(" "),s("div",{staticClass:"list-flat__desc"},[s("div",[e._v(e._s(e.staticFlatsSchemasTypes[t.type].title))]),e._v(" "),s("div",{staticClass:"list-flat__desc_price"},[e._v("от 1,25 млн.руб.")])]),e._v(" "),s("div",{staticClass:"list-flat__amount"},[e._v(e._s(t.number_of))])])}),e._v(" "),e.isVisibleButtons?s("div",{staticClass:"item-buttons"},[e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Редактировать",color:"green",actionForClick:e.redirectToEditHouse}}):e._e(),e._v(" "),e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Удалить",color:"grey",actionForClick:e.removeHouse}}):e._e()],1):e._e()],2)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"desc-type"},[t("span",{staticClass:"desc-type__badge"},[this._v("Жилой комплекс")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"desc-amount__title"},[this._v("Осталось"),t("br"),this._v("квартир")])}]};var Q={name:"BuildingMain",data:()=>({hashId:"",name:"",region:"",district:"",city:"",country:"",video:"",images:"",coords:[],houses:[],alertMessage:"",selectedHouseId:"",alertConfirm:{isActive:!1,additionalMessage:"Если вы удалите этот объект, то все данные будут отображаться не корректно"}}),components:{HouseItem:s("VU/8")(X,z,!1,function(e){s("Bjlk")},"data-v-a393991e",null).exports,ButtonDefault:f,AlertDefault:O,AlertConfirm:J},created(){let e=this.$route.params.buildingStoreIndex;void 0!==e&&this.$store.dispatch("setItemToStore",{storageName:"currentBuildingStoreIndex",fields:e});let t=this.$store.state.currentBuildingStoreIndex;null!==t&&this.fillBuildingsByData(t)},methods:{getHouses(e){return this.$store.dispatch("retrieveItem",{url:"/buildings/"+e+"/houses",storageName:"houses"}).then(e=>{this.houses=e.data,this.$store.dispatch("setItemToStore",{storageName:"houses",fields:JSON.stringify(this.houses)})}).catch(e=>{this.alertMessage="Не могу получить список домов. Обратитесь к администратору.",console.info(e.response.data)})},fillBuildingsByData(e){let t=this.$store.state.buildings,s=JSON.parse(t)[e].building;this.hashId=s.hash_id,this.name=s.name,this.country=s.country,this.region=s.region,this.currency=s.currency,this.city=s.city,this.district=s.district,this.video=s.video,this.images=s.images,this.coords=s.coordinates,this.getHouses(this.hashId)},redirectToHouseProperties(){this.$store.dispatch("destroyItemFromStore","currentHouseId"),this.$store.dispatch("destroyItemFromStore","properties"),this.$router.push({name:"HouseProperties",params:{houseStoreIndex:this.storeIndex}})},removeHouse(){console.info("remH",this.selectedHouseId),this.$store.dispatch("removeItem",{url:"/houses/"+this.selectedHouseId}).then(()=>{this.alertMessage="Дом успешно удалён",this.getHouses(this.hashId)}).catch(e=>{this.alertMessage="Не удалось удалить дом",console.info("Не удалось удалить дом. Вот почему: ",e.response.data)}),this.closeAlertConfirm()},activateAlertConfirm(e){this.selectedHouseId=e,this.alertConfirm.isActive=!0},closeAlertConfirm(){this.alertConfirm.isActive=!1}}},Z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",{staticClass:"building-title"},[e._v(e._s(e.name))]),e._v(" "),s("div",{staticClass:"building"},[s("div",{staticClass:"building-info"},[e._m(0),e._v(" "),s("div",{staticClass:"info-grid"},[s("div",[s("span",[e._v("Страна: ")]),e._v(e._s(e.country))]),e._v(" "),s("div",[s("span",[e._v("Регион: ")]),e._v(e._s(e.region))]),e._v(" "),s("div",[s("span",[e._v("Город: ")]),e._v(e._s(e.city))]),e._v(" "),s("div",[s("span",[e._v("Район: ")]),e._v(e._s(e.district))])])]),e._v(" "),e._m(1),e._v(" "),e.alertMessage?s("AlertDefault",{attrs:{message:e.alertMessage},on:{alertDie:function(t){e.alertMessage=""}}}):e._e(),e._v(" "),e.alertConfirm.isActive?s("AlertConfirm",{attrs:{additionalMessage:e.alertConfirm.additionalMessage},on:{isAgree:e.removeHouse,isDisagree:e.closeAlertConfirm}}):e._e()],1),e._v(" "),s("div",{staticClass:"buildings"},[s("div",{staticClass:"buildings-create"},[s("div",{staticClass:"create"},[s("div",{staticClass:"create-title"},[e._v("Новый объект")]),e._v(" "),s("div",{staticClass:"create-button"},[s("ButtonDefault",{staticClass:"create-button__add button-expand",attrs:{name:"Добавить объект",color:"grey",actionForClick:e.redirectToHouseProperties}}),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Создадим за вас",color:"green"}})],1),e._v(" "),e._m(2)]),e._v(" "),s("img",{staticClass:"create-image",attrs:{src:"/static/img/PersonalManager.jpg",alt:""}})]),e._v(" "),e._l(e.houses,function(t,a){return s("HouseItem",{key:t.house.id,attrs:{houseId:t.house.hash_id,numberOfFloors:t.house.number_of_floors,livingFloors:t.house.living_floors,numberOfEntrance:t.house.number_of_entrance,numberOfFlat:t.house.number_of_flat,streetName:t.house.street_name,storeIndex:a,title:t.house.name,number:t.house.number,flats:t.flats,finishing:t.house.finishing,stageDevelopment:t.house.stage_development,startDevelopment:t.house.start_development,endDevelopment:t.house.end_development},on:{activateAlertConfirm:e.activateAlertConfirm}})})],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"info-box"},[t("div",{staticClass:"info-title"},[this._v("Расположение объекта:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"building-media"},[t("div",{staticClass:"building-media__images"},[t("img",{attrs:{src:"https://novostroy-a.akamaihd.net/regions/u/b/g/box_orig/591ae91edf75a.jpg"}})])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"create-desc"},[this._v("Доверьте создание объекта персональному "),t("span",[this._v("менеджеру")]),this._v(".")])}]};var ee=s("VU/8")(Q,Z,!1,function(e){s("av+i")},"data-v-d92c236e",null).exports,te={name:"BuildingProperties",components:{ButtonDefault:f,AlertDefault:O},data:()=>({hashId:"",name:"",region:"",district:"",city:"",country:"",video:"",images:"",coords:[],currency:"",errorsStack:[],editMode:!1}),created(){let e=this.$route.params.buildingStoreIndex;void 0!==e&&this.$store.dispatch("setItemToStore",{storageName:"currentBuildingStoreIndex",fields:e});let t=this.$store.state.currentBuildingStoreIndex;null!==t&&(this.editMode=!0,this.fillLinesByData(t))},methods:{storeBuildingsProperties(e="",t="writeItem"){const s={company_id:this.$store.state.companyHashId,name:this.name,region:this.region,district:this.district,city:this.city,country:this.country,video:this.video,images:this.images,coordinates:this.coords,currency:this.currency};this.$store.dispatch(t,{fields:s,url:"/buildings"+e,storageName:"buildingProperties"}).then(()=>{this.$router.push("/")}).catch(e=>{this.errorsStack=e.response.data})},updateBuildingsProperties(){this.storeBuildingsProperties("/"+this.hashId,"updateItem")},fillLinesByData(e){let t=this.$store.state.buildings,s=JSON.parse(t)[e].building;this.hashId=s.hash_id,this.name=s.name,this.country=s.country,this.region=s.region,this.currency=s.currency,this.city=s.city,this.district=s.district,this.video=s.video,this.images=s.images,this.coords=s.coordinates},clearSingleError(){this.$delete(this.errorsStack,"single_error")},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null}}},se={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"buildings-properties"},[s("div",{staticClass:"properties-form"},[s("div",{staticClass:"form-title"},[e._v("Введите информацию о комплексе:")]),e._v(" "),s("div",{staticClass:"form-group properties-title"},[s("label",{staticClass:"form-group__label",attrs:{for:"name"}},[e._v("Название ЖК")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{id:"name",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})])]),e._v(" "),e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"form-subtitle"},[e._v("Расположение:")]),e._v(" "),s("div",{staticClass:"form-grid"},[s("div",{staticClass:"form-group properties-group"},[s("label",{staticClass:"form-group__label label",attrs:{for:"country"}},[e._v("Страна")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.country?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.country[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.country,expression:"country"}],class:e.validationClass.country,attrs:{name:"country",id:"country"},domProps:{value:e.country},on:{click:e.clearError,input:function(t){t.target.composing||(e.country=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group properties-group"},[s("label",{staticClass:"form-group__label label",attrs:{for:"region"}},[e._v("Регион")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.region?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.region[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.region,expression:"region"}],class:e.validationClass.region,attrs:{name:"region",id:"region"},domProps:{value:e.region},on:{click:e.clearError,input:function(t){t.target.composing||(e.region=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group properties-group"},[s("label",{staticClass:"form-group__label label",attrs:{for:"currency"}},[e._v("Валюта")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.currency?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.currency[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.currency,expression:"currency"}],class:e.validationClass.currency,attrs:{name:"currency",id:"currency"},domProps:{value:e.currency},on:{click:e.clearError,input:function(t){t.target.composing||(e.currency=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group properties-group"},[s("label",{staticClass:"form-group__label label",attrs:{for:"city"}},[e._v("Город")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.city?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.city[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.city,expression:"city"}],class:e.validationClass.city,attrs:{name:"city",id:"city"},domProps:{value:e.city},on:{click:e.clearError,input:function(t){t.target.composing||(e.city=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group properties-group"},[s("label",{staticClass:"form-group__label label",attrs:{for:"district"}},[e._v("Район")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.district?s("span",{staticClass:"form-group__alert"},[e._v("\n              "+e._s(e.errorsStack.district[0])+"\n            ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.district,expression:"district"}],class:e.validationClass.district,attrs:{name:"district",id:"district"},domProps:{value:e.district},on:{click:e.clearError,input:function(t){t.target.composing||(e.district=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)])]),e._v(" "),s("div",[e.editMode?s("ButtonDefault",{attrs:{name:"Обновить",color:"green",actionForClick:e.updateBuildingsProperties}}):s("ButtonDefault",{attrs:{name:"Сохранить",color:"green",actionForClick:e.storeBuildingsProperties}})],1)],1),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"properties-media"},[t("div",{staticClass:"media-create"},[t("button",{staticClass:"button button-expand",attrs:{type:"button","button-color":"yellow"}},[this._v("\n        Добавить фото и видео\n      ")])])])}]};var ae=s("VU/8")(te,se,!1,function(e){s("o1yK")},"data-v-223b6aa2",null).exports,re={name:"HouseContainer",components:{ButtonDefault:f}},ie={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"house-container"},[s("div",{staticClass:"house-header"},[s("div",{staticClass:"header-top"},[s("div",{staticClass:"header-title"},[s("router-link",{staticClass:"header-title__link",attrs:{to:{name:"BuildingMain"}}},[e._v('ЖК "Millennium Falcon"')])],1),e._v(" "),s("ButtonDefault",{staticClass:"button",attrs:{name:"Удалить объект",color:"red"}})],1),e._v(" "),s("ul",{staticClass:"header-nav"},[s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{step:"1",to:{name:"HouseProperties"}}},[s("span",{staticClass:"nav-link__step"},[e._v("1.")]),e._v(" "),s("span",{staticClass:"nav-link__title"},[e._v("Характеристики дома")])])],1),e._v(" "),s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{step:"2",to:{name:"HouseFlatsSchemas"}}},[s("span",{staticClass:"nav-link__step"},[e._v("2.")]),e._v(" "),s("span",{staticClass:"nav-link__title"},[e._v("Типовые планровки")])])],1),e._v(" "),s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{step:"3",to:{name:"HouseFloors"}}},[s("span",{staticClass:"nav-link__step"},[e._v("3.")]),e._v(" "),s("span",{staticClass:"nav-link__title"},[e._v("Типовые этажи")])])],1),e._v(" "),s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{step:"4",to:{name:"HouseChess"}}},[s("span",{staticClass:"nav-link__step"},[e._v("4.")]),e._v(" "),s("span",{staticClass:"nav-link__title"},[e._v("Шахматка")])])],1),e._v(" "),s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{step:"5",to:{name:"HousePrices"}}},[s("span",{staticClass:"nav-link__step"},[e._v("5.")]),e._v(" "),s("span",{staticClass:"nav-link__title"},[e._v("Цены")])])],1)])]),e._v(" "),e._t("default")],2)},staticRenderFns:[]};var oe=s("VU/8")(re,ie,!1,function(e){s("a3GO")},"data-v-13e8f546",null).exports,ne={name:"Sidebar",props:{title:{type:String,default:"default title"}},methods:{closeSidebar(){this.$emit("closeSidebar")}}},le={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("div",{staticClass:"container",on:{click:e.closeSidebar}}),e._v(" "),s("div",{staticClass:"sidebar"},[s("button",{staticClass:"uk-offcanvas-close",attrs:{type:"button","uk-close":""},on:{click:e.closeSidebar}}),e._v(" "),s("div",{staticClass:"sidebar-header"},[s("h1",[e._v(e._s(e.title))])]),e._v(" "),s("div",{staticClass:"sidebar-body"},[e._t("default")],2)])])])},staticRenderFns:[]};var ce=s("VU/8")(ne,le,!1,function(e){s("Rqa9")},"data-v-5639d55c",null).exports,de={name:"HouseFloorsAdd",data(){return{floorNumber:this.selectedFloor.number||"",numberOfFlats:this.selectedFloor.number_of_flats||"",cloneFloors:[],floorImage:this.selectedFloor.image||"",imagePreview:"",freeFloors:[],errorsStack:{}}},props:{storeIndex:String,houseId:{type:String,require:!0},selectedFloor:Object,editMode:{type:Boolean,default:!1},sidebarShow:{type:Boolean,default:!1}},components:{AlertDefault:O,ButtonDefault:f,Sidebar:ce},created(){this.floorNumber=this.cFreeFloors[0]-1},methods:{closeSidebarToFloor(){this.$emit("closeSidebar")},resetImage(){this.flatSchemaImage="",this.imagePreview=""},storeFloor(e="",t="writeItem"){let s=new FormData;const a={api_key:this.$store.state.apiKey,house_id:this.houseId,number:this.floorNumber,number_of_flats:this.numberOfFlats,clone_floors:this.convertFloorRangeToSequence(this.cloneFloors),image:this.floorImage};for(let e in a)s.append(e,a[e]);return this.$store.dispatch(t,{fields:s,url:"/floor-types"+e,storageName:"houseFloor"})},writeFloor(){this.storeFloor().then(()=>{this.$emit("refreshAfterChange")}).catch(e=>{this.errorsStack=e.response.data,console.info(e)})},updateFloor(){this.storeFloor("/"+this.selectedFloor.hash_id,"updateItem").then(()=>{this.$emit("refreshAfterChange")}).catch(e=>{this.errorsStack=e.response.data,console.info(e.response.data)})},chooseCloneFloor(e){let t=Number(e.target.value),s=this.cFreeFloors[0];this.cloneFloors.length>2&&(this.cloneFloors=[],this.cloneFloors.push(t)),this.cloneFloors.sort((e,t)=>e-t),this.cloneFloors[0]>s&&(this.errorsStack.single_error=!0,this.errorsStack.message="Вы не можете оставить предыдущие этажи пустыми",this.cloneFloors=[],setTimeout(()=>{this.errorsStack.single_error=!1,this.errorsStack.message=""},3e3))},clearSingleError(){this.$delete(this.errorsStack,"single_error")},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()},processFile(e){this.floorImage=e.target.files[0],this.floorImage=e.target.files[0];let t=new FileReader;t.onloadend=(()=>{this.imagePreview=t.result}),this.floorImage?t.readAsDataURL(this.floorImage):this.imagePreview=""},convertFloorRangeToSequence(e){let t=[];for(let s=Number(e[0]);s<=Number(e[e.length-1]);s++)t.push(s);return t}},computed:{sidebarShowComputed(){return this.sidebarShow},cFreeFloors(){let e=JSON.parse(this.$store.state.properties).living_floors.split(",");e[0]=Number(e[0])+1;let t=JSON.parse(this.$store.state.houseFloors);if(t.length){let s=t.reverse()[0].clone_floors.split(",").reverse()[0];s&&(e[0]=Number(s)+2)}return this.convertFloorRangeToSequence(e)},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null},validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e}}},ue={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.sidebarShowComputed?s("Sidebar",{attrs:{title:"Создание"},on:{closeSidebar:e.closeSidebarToFloor}},[e.errorsStack.single_error?s("AlertDefault",{attrs:{message:e.errorsStack.message},on:{alertDie:e.clearSingleError}}):e._e(),e._v(" "),s("div",[e.editMode?s("img",{attrs:{width:"100",height:"100",src:e.image}}):e._e(),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.floor_number?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.floor_number)+"\n          ")]):e._e()]),e._v("\n        № этажа:\n        "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.floorNumber,expression:"floorNumber",modifiers:{number:!0}}],class:e.validationClass.floor_number,attrs:{name:"floor_number",id:"floor_number"},domProps:{value:e.floorNumber},on:{click:e.clearError,input:function(t){t.target.composing||(e.floorNumber=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})],1)]),e._v(" "),s("div",[e._v("\n      Клонировать для этажей:\n      "),s("div",e._l(e.cFreeFloors,function(t,a){return s("span",{key:a},[s("label",{attrs:{for:t}},[e._v(e._s(t))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.cloneFloors,expression:"cloneFloors"}],attrs:{type:"checkbox",id:t},domProps:{value:t,checked:Array.isArray(e.cloneFloors)?e._i(e.cloneFloors,t)>-1:e.cloneFloors},on:{change:[function(s){var a=e.cloneFloors,r=s.target,i=!!r.checked;if(Array.isArray(a)){var o=t,n=e._i(a,o);r.checked?n<0&&(e.cloneFloors=a.concat([o])):n>-1&&(e.cloneFloors=a.slice(0,n).concat(a.slice(n+1)))}else e.cloneFloors=i},e.chooseCloneFloor]}})])}))]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_flats?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.number_of_flats)+"\n          ")]):e._e()]),e._v("\n        Количество квартир на этаже:\n        "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.numberOfFlats,expression:"numberOfFlats"}],class:e.validationClass.number_of_flats,attrs:{name:"number_of_flats",id:"number_of_flats"},domProps:{value:e.numberOfFlats},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfFlats=t.target.value)}}})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.image?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.image)+"\n          ")]):e._e()]),e._v("\n        Изображение: "),s("input",{attrs:{name:"image",type:"file"},on:{change:e.processFile}}),e._v(" "),s("button",{attrs:{type:"button"},on:{click:e.resetImage}},[e._v("Х")]),e._v(" "),s("img",{attrs:{width:"200px",height:"200px",src:e.imagePreview}})],1)]),e._v(" "),e.editMode?s("ButtonDefault",{attrs:{name:"Обновить",color:"green",actionForClick:e.updateFloor}}):s("ButtonDefault",{attrs:{name:"Создать этаж",color:"green",actionForClick:e.writeFloor}})],1)],1):e._e()},staticRenderFns:[]};var me=s("VU/8")(de,ue,!1,function(e){s("3l8V")},"data-v-e8c60a4e",null).exports,_e={name:"HouseFloorsItem",data:()=>({isVisibleButtons:!1,sidebarShow:!1}),components:{ButtonDefault:f,HouseFloorsAdd:me},props:{houseId:{type:String,require:!0},floorId:{type:String,require:!0},image:{type:String,require:!0},floorNumber:{type:Number,require:!0},markingEnable:{type:Boolean,require:!0},cloneFloors:{type:Array,require:!0},numberOfFlats:{type:Number,require:!0},storeIndex:{type:Number,require:!0}},methods:{toggleEditButton(){this.isVisibleButtons=!this.isVisibleButtons},emitMarkingFloor(){this.$emit("emitMarkingFloor",{id:this.floorId,storeIndex:this.storeIndex,numberOfFlats:this.numberOfFlats,markingEnable:this.markingEnable})},removeFloor(){this.$emit("activateAlertConfirm",this.floorId)},editFloor(){this.$emit("activateSidebar",this.storeIndex)}}},ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"floors-item",on:{mouseover:e.toggleEditButton,mouseout:e.toggleEditButton}},[s("div",{staticClass:"item-buttons"},[e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-small",attrs:{name:"Редактировать",color:"green",actionForClick:e.editFloor}}):e._e(),e._v(" "),e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-small",attrs:{name:"Удалить",color:"red",actionForClick:e.removeFloor}}):e._e()],1),e._v(" "),s("div",{staticClass:"item-image"},[s("img",{attrs:{src:"/static/img"+e.image}})]),e._v(" "),s("div",{staticClass:"item-desc"},[e.markingEnable?s("div",[e._v("\n      Этаж доступен для разметки\n    ")]):e._e(),e._v(" "),s("div",[e._v("\n      № этажа: "+e._s(e.floorNumber)+"\n    ")]),e._v(" "),s("div",{staticClass:"item-desc__clone"},[s("div",{staticClass:"clone-title"},[e._v("Клонировать для этажей:")]),e._v(" "),s("div",{staticClass:"clone-items"},e._l(e.cloneFloors,function(t,a){return s("span",{key:a,staticClass:"clone-item"},[e._v(e._s(t))])}))]),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Разметить этаж",color:"yellow",actionForClick:e.emitMarkingFloor}})],1)])},staticRenderFns:[]};var pe=s("VU/8")(_e,ve,!1,function(e){s("WaQG")},"data-v-b0e2dba4",null).exports,he={name:"FlatMarked",data(){return{alertShow:!1,singleErrorMessage:"",number:this.flatType.number,flatSchema:this.flatType.flat_schema_hash_id,entrance:this.flatType.entrance,windows:this.flatTypeWindows,selectedFlatType:[],staticFlatsSchemas:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}}}},props:{flatType:{type:Object,required:!0},flatTypeId:{type:String,required:!0},flatIndex:{type:Number,required:!0},editableFlatIndex:Number,flatTypeNumber:{type:Number,required:!0},flatSchemas:{type:Array,required:!0},flatTypeWindows:{type:Array,required:!0},errorsStack:Array},components:{AlertConfirm:J,ButtonDefault:f,AlertDefault:O},methods:{alertConfirm(){this.alertShow=!0},updateFlat(){this.$emit("updateFlat",{id:this.flatTypeId,number:this.number,flatSchema:this.flatSchema,entrance:this.entrance,windows:this.windows})},removeFlat(){this.$store.dispatch("removeItem",{url:"/flat-types/"+this.flatTypeId}).then(()=>{this.$emit("flatTypeRemovedSuccessful")}).catch(()=>{this.singleErrorMessage="Не удалось удалить квартиру.",console.info("Не удалось удалить квартиру."),this.closeAlertConfirm()})},closeAlertConfirm(){this.alertShow=!1},editBlock(){this.editMode||this.$emit("setCurrentCoordinates",{flatTypeId:this.flatTypeId,flatIndex:this.flatIndex,coords:this.flatType.coordinates})},clearSingleError(){this.singleErrorMessage=""},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()}},watch:{errorsStack(e){console.info(e),this.singleErrorMessage=e.message}},computed:{editMode(){return this.editableFlatIndex===this.flatIndex},selectedFlatSchema(){return this.flatSchemas.map(e=>this.flatSchema===e.fields.type),!1}}},fe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flat-marked",class:e.flatTypeId,on:{click:e.editBlock}},[s("div",{staticClass:"marked-item"},[s("div",[e._v("Квартира № "+e._s(e.flatTypeNumber))]),e._v(" "),s("div",[s("ButtonDefault",{staticClass:"button-icon",attrs:{actionForClick:e.alertConfirm}})],1)]),e._v(" "),s("transition",{attrs:{name:"slide-fade"}},[e.editMode?s("div",{staticClass:"marked-form"},[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:e.clearSingleError}}):e._e(),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number"}},[e._v("Квартира №")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.number,expression:"number"}],attrs:{type:"number",name:"number",id:"number"},domProps:{value:e.number},on:{input:function(t){t.target.composing||(e.number=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})])]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"flatSchema"}},[e._v("Планировка")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.flatSchema,expression:"flatSchema"}],attrs:{type:"flatSchema",name:"flatSchema",id:"flatSchema"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.flatSchema=t.target.multiple?s:s[0]}}},e._l(e.flatSchemas,function(t){return s("option",{key:t.fields.hash_id,domProps:{value:t.fields.hash_id,selected:e.selectedFlatSchema}},[e._v("\n              "+e._s(e.staticFlatsSchemas[t.fields.type].title)+"\n            ")])})),e._v(" "),s("span",{staticClass:"form-group__input_bar"})])]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"entrance"}},[e._v("Подъезд №")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.entrance,expression:"entrance"}],attrs:{type:"number",name:"entrance",id:"entrance"},domProps:{value:e.entrance},on:{input:function(t){t.target.composing||(e.entrance=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})])]),e._v(" "),s("div",{staticClass:"marked-window"},[s("div",{staticClass:"window-title"},[e._v("Окна выходят на:")]),e._v(" "),s("div",{staticClass:"window-list"},[s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"street",value:"Улица",name:"street"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Улица")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Улица");a.checked?i<0&&(e.windows=s.concat(["Улица"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"street"}},[e._v("Улица")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"north",value:"Север",name:"north"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Север")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Север");a.checked?i<0&&(e.windows=s.concat(["Север"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"north"}},[e._v("Север")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"south",value:"Юг"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Юг")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Юг");a.checked?i<0&&(e.windows=s.concat(["Юг"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"south"}},[e._v("Юг")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"outdoors",value:"Двор"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Двор")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Двор");a.checked?i<0&&(e.windows=s.concat(["Двор"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"outdoors"}},[e._v("Двор")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"east",value:"Восток"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Восток")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Восток");a.checked?i<0&&(e.windows=s.concat(["Восток"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"east"}},[e._v("Восток")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.windows,expression:"windows"}],attrs:{type:"checkbox",id:"west",value:"Запад"},domProps:{checked:Array.isArray(e.windows)?e._i(e.windows,"Запад")>-1:e.windows},on:{change:function(t){var s=e.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Запад");a.checked?i<0&&(e.windows=s.concat(["Запад"])):i>-1&&(e.windows=s.slice(0,i).concat(s.slice(i+1)))}else e.windows=r}}}),e._v(" "),s("label",{attrs:{for:"west"}},[e._v("Запад")])])])]),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Сохранить квартиру",color:"green",actionForClick:e.updateFlat}})],1):e._e()]),e._v(" "),e.alertShow?s("AlertConfirm",{on:{isAgree:e.removeFlat,isDisagree:e.closeAlertConfirm}}):e._e()],1)},staticRenderFns:[]};var ge=s("VU/8")(he,fe,!1,function(e){s("cBBD")},"data-v-3a705740",null).exports,be={name:"HouseFloorsMarking",data(){return{houseId:this.$store.state.currentHouseId,flatsSchemasOfCurrentHouse:[],staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},newFlat:{number:"",flatSchemaId:[],entrance:"",windows:[],selectedPointIndex:"",points:[]},flatColors:[],flatTypes:[],originalFlatTypes:[],editMode:!1,errorsStack:[],editableFlatIndex:null,alertMessage:""}},props:{currentFloorId:String,numberOfFlats:{type:Number,required:!0}},components:{FlatMarked:ge,ButtonDefault:f,AlertDefault:O},mixins:[m],created(){this.getFlatTypes(),this.getFlatsSchemas()},methods:{getFlatsSchemas(){if(null===this.$store.state.flatsSchemas)return this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId+"/flats-schemas",storageName:"flatsSchemas"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"flatsSchemas",fields:e.data}).then(()=>{this.flatsSchemasOfCurrentHouse=JSON.parse(e.data)}).catch(e=>{console.info("Не удалось получить планировки. Вот почему: ",e.response.data)})});this.flatsSchemasOfCurrentHouse=JSON.parse(this.$store.state.flatsSchemas)},getFlatTypes(){return this.$store.dispatch("retrieveItem",{url:"/floor-type/"+this.currentFloorId+"/flat-types",storageName:"flatTypes"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"flatTypes",fields:e.data}).then(()=>{this.originalFlats=e.data,this.flatTypes=JSON.parse(e.data),this.flatTypes.map(e=>{})}).catch(e=>{500===e.response.status?this.alertMessage="Что-то пошло не так.":(this.errorsStack=e.response.data,this.alertMessage=e.response.message)})})},resetEdit(){this.flatTypes=JSON.parse(this.originalFlats),this.newFlat.points=[]},editBlock(e){this.resetEdit(),this.editMode=!0,this.editableFlatIndex=e.flatIndex,this.flatTypes.map(t=>{t.fields.hash_id===e.flatTypeId&&(t.fields.coordinates="")}),e.coords.split(" ").map(e=>{let t=e.split(",");this.updatePoints({layerX:t[0],layerY:t[1]})})},storeMarkedFlat(e="",t="writeItem"){let s={house_id:this.houseId,floor_type_id:this.currentFloorId,flat_schema_id:this.newFlat.flatSchemaId,entrance:this.newFlat.entrance,number:this.newFlat.number,windows:this.newFlat.windows.join(","),coordinates:this.totalPoints};return this.$store.dispatch(t,{fields:s,url:"/flat-types",storageName:"flatMarking"})},writeMarkedFlat(){let e=this.flatTypes.length-1;if(e>=0){let t=Number(this.flatTypes[e].fields.number),s=Number(this.flatTypes[e].fields.entrance);if(this.newFlat.number-t!=1&&this.newFlat.entrance===s)return void(this.alertMessage="Вы должны создавать квартиры последовательно!")}this.storeMarkedFlat().then(()=>{this.newFlat.points=[],this.getFlatTypes()}).catch(e=>{500===e.response.status?this.alertMessage="Что-то пошло не так.":(console.info(e.response),this.errorsStack=e.response.data,this.alertMessage=e.response.data.message)})},closeMarking(){this.$emit("closeMarking")},updateMarkedFlat(e){let t={house_id:this.houseId,floor_type_id:this.currentFloorId,flat_schema_id:e.flatSchema,entrance:e.entrance,number:e.number,windows:e.windows.join(","),coordinates:this.totalPoints};return this.$store.dispatch("updateItem",{fields:t,url:"/flat-types/"+e.id,storageName:"flatMarking"}).then(()=>{this.newFlat.points=[],this.getFlatTypes()}).catch(e=>{500===e.response.status?this.alertMessage="Что-то пошло не так.":(console.info(e.response),this.errorsStack=e.response.data,this.alertMessage=e.response.data.message)})},processFile(e){this.newFlat.flatSchema=e.target.files[0]},updatePoints(e){this.setPoint(e.layerX,e.layerY)},checkSamePosition(e,t,s,a){const r=Math.abs(e-s),i=Math.abs(t-a);return r<=10&&i<=10},setPoint(e,t){this.newFlat.points.push({x:e,y:t})},rightClick(e){e.preventDefault();let t=e.layerX,s=e.layerY;for(let e in this.newFlat.points){let a=this.newFlat.points[e];this.checkSamePosition(a.x,a.y,t,s)&&this.newFlat.points.splice(e,1)}},removeMarking(e){e.preventDefault(),this.newFlat.points=[]},handleMouseDown(e){0===e.button&&(this.newFlat.selectedPointIndex=this.newFlat.points.findIndex(t=>{return this.checkSamePosition(t.x,t.y,e.layerX,e.layerY)}),document.addEventListener("mousemove",this.handleMouseMove))},handleMouseUp(e){0===e.button&&(document.removeEventListener("mousemove",this.handleMouseMove),this.newFlat.selectedPointIndex="")},handleMouseMove(e){let t=this.newFlat.selectedPointIndex;this.newFlat.points[t].x=e.layerX,this.newFlat.points[t].y=e.layerY},addNewFlatColor(){this.flatColors.push("#"+Math.floor(999999*Math.random()))},createNewObject(){this.resetEdit(),this.editMode=!1,this.editableFlatIndex=null},clearSingleError(){this.$delete(this.errorsStack,"single_error")},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()}},computed:{totalPoints(){let e="";return this.newFlat.points.map(function(t){e+=" "+t.x+","+t.y}),e.trim()},readyFlatsCoordinates(){let e={};return this.flatTypes.map(t=>{e[t.fields.hash_id]=t.fields.coordinates,this.addNewFlatColor()}),e},computedFlatTypes(){return this.flatTypes},markingIsNotCompleted(){return this.computedFlatTypes.length-this.numberOfFlats!=0},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null},validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e}}},Ce={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"floors-marking"},[s("div",{staticClass:"floors-nav"},[s("ButtonDefault",{staticClass:"button-close",attrs:{actionForClick:e.closeMarking}})],1),e._v(" "),s("div",{staticClass:"floors-grid"},[s("div",{staticClass:"floors-image"},[s("img",{attrs:{src:"/static/img/plan.svg"}}),e._v(" "),s("svg",{staticClass:"floors-schema",on:{click:e.updatePoints}},[e._l(e.readyFlatsCoordinates,function(t,a,r){return[s("polygon",{key:a,class:a,style:{fill:e.flatColors[r]},attrs:{points:t}})]}),e._v(" "),s("polygon",{attrs:{points:e.totalPoints},on:{contextmenu:e.removeMarking}}),e._v(" "),e._l(e.newFlat.points,function(t,a){return[s("circle",{key:t.x+""+a,attrs:{cx:t.x,cy:t.y,r:"6"},on:{contextmenu:e.rightClick,mouseup:e.handleMouseUp,mousedown:e.handleMouseDown}})]})],2)])]),e._v(" "),s("div",{staticClass:"floors-flats"},[s("div",[s("div",e._l(e.computedFlatTypes,function(t,a){return s("FlatMarked",{key:t.fields.hash_id,attrs:{flatType:t.fields,flatTypeWindows:t.fields.windows.split(","),flatTypeId:t.fields.hash_id,flatTypeNumber:t.fields.number,flatIndex:a,flatSchemas:e.flatsSchemasOfCurrentHouse,editableFlatIndex:e.editableFlatIndex,errorsStack:e.errorsStack},on:{flatTypeRemovedSuccessful:e.getFlatTypes,setCurrentCoordinates:e.editBlock,updateFlat:e.updateMarkedFlat}})})),e._v(" "),s("div",{staticClass:"marked-create",on:{click:e.createNewObject}},[e._v("Новый объект")]),e._v(" "),e.editMode?e._e():s("div",{staticClass:"marked-form"},[e.alertMessage?s("AlertDefault",{attrs:{message:e.alertMessage},on:{alertDie:function(t){e.alertMessage=""}}}):e._e(),e._v(" "),e.markingIsNotCompleted?s("h2",[e._v("Этаж не размечен до конца")]):e._e(),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number"}},[e._v("Квартира №")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number?s("span",{staticClass:"form-group__alert"},[e._v("\n                "+e._s(e.errorsStack.number)+"\n              ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.newFlat.number,expression:"newFlat.number",modifiers:{number:!0}}],class:e.validationClass.number,attrs:{type:"number",name:"number",id:"number"},domProps:{value:e.newFlat.number},on:{click:e.clearError,input:function(t){t.target.composing||e.$set(e.newFlat,"number",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.flat_schema_hash_id?s("span",{staticClass:"form-group__alert"},[e._v("\n                "+e._s(e.errorsStack.flat_schema_hash_id)+"\n              ")]):e._e()]),e._v("\n          Планировка\n          "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.flatSchemaId,expression:"newFlat.flatSchemaId"}],class:e.validationClass.flat_schema_hash_id,attrs:{type:"flatSchema",name:"flat_schema_hash_id",id:"flat_schema_hash_id"},on:{click:e.clearError,change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.newFlat,"flatSchemaId",t.target.multiple?s:s[0])}}},e._l(e.flatsSchemasOfCurrentHouse,function(t){return s("option",{key:t.fields.hash_id,domProps:{value:t.fields.hash_id}},[e._v("\n              "+e._s(e.staticFlatsSchemasTypes[t.fields.type].title)+"\n            ")])}))],1),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"entrance"}},[e._v("Подъезд №")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.entrance?s("span",{staticClass:"form-group__alert"},[e._v("\n                "+e._s(e.errorsStack.entrance)+"\n              ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.newFlat.entrance,expression:"newFlat.entrance",modifiers:{number:!0}}],class:e.validationClass.entrance,attrs:{type:"number",name:"entrance",id:"entrance"},domProps:{value:e.newFlat.entrance},on:{click:e.clearError,input:function(t){t.target.composing||e.$set(e.newFlat,"entrance",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"marked-window"},[s("div",{staticClass:"window-title"},[e._v("Окна выходят на:")]),e._v(" "),s("div",{staticClass:"window-list"},[s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"street",value:"Улица"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Улица")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Улица");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Улица"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"street"}},[e._v("Улица")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"north",value:"Север"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Север")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Север");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Север"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"north"}},[e._v("Север")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"south",value:"Юг"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Юг")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Юг");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Юг"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"south"}},[e._v("Юг")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"outdoors",value:"Двор"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Двор")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Двор");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Двор"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"outdoors"}},[e._v("Двор")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"east",value:"Восток"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Восток")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Восток");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Восток"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"east"}},[e._v("Восток")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newFlat.windows,expression:"newFlat.windows"}],attrs:{type:"checkbox",id:"west",value:"Запад"},domProps:{checked:Array.isArray(e.newFlat.windows)?e._i(e.newFlat.windows,"Запад")>-1:e.newFlat.windows},on:{change:function(t){var s=e.newFlat.windows,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Запад");a.checked?i<0&&e.$set(e.newFlat,"windows",s.concat(["Запад"])):i>-1&&e.$set(e.newFlat,"windows",s.slice(0,i).concat(s.slice(i+1)))}else e.$set(e.newFlat,"windows",r)}}}),e._v(" "),s("label",{attrs:{for:"west"}},[e._v("Запад")])])])]),e._v(" "),s("ButtonDefault",{staticClass:"button-expand",attrs:{name:"Сохранить квартиру",color:"green",actionForClick:e.writeMarkedFlat}})],1)])])])},staticRenderFns:[]};var we=s("VU/8")(be,Ce,!1,function(e){s("eCkp")},"data-v-59c36557",null).exports,ye={name:"HouseFloorsList",data:()=>({houseId:"",selectedFloor:{id:"",numberOfFlats:null},floorMarking:!1,alertConfirm:{isActive:!1,additionalMessage:"Если вы удалите этот объект, то все данные будут отображаться не корректно"},alertMessage:"",floors:[],sidebar:{show:!1,editMode:!1,storeIndex:"",selectedFloor:{}}}),components:{ButtonDefault:f,AlertConfirm:J,AlertDefault:O,HouseContainer:oe,HouseFloorsAdd:me,HouseFloorsItem:pe,HouseFloorsMarking:we},created(){this.houseId=this.$store.state.currentHouseId,void 0!==this.houseId&&this.getFloors()},methods:{closeSidebar(){Object.assign(this.$data.sidebar,this.$options.data().sidebar)},closeMarking(){this.floorMarking=!1,this.getFloors()},getBack(){this.$router.push({name:"HouseFlatsSchemas"})},getFloors(){this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId+"/floor-types",storageName:"houseFloors"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"houseFloors",fields:JSON.stringify(e.data)}).then(()=>{this.floors=e.data}).catch(e=>{this.alertMessage="Не могу получить список этажей. Обратитесь к администратору",console.info("Не могу получить список этажей. Вот почему: ",e.response.data)})})},markingFloor(e){this.floorMarking=e.markingEnable,this.selectedFloor.id=e.id,this.selectedFloor.numberOfFlats=e.numberOfFlats,this.floorMarking||(this.alertMessage="Сначала Вы должны разметить предыдущий этаж")},activateSidebar(e){void 0!==e&&(this.sidebar.storeIndex=e,this.sidebar.selectedFloor=this.floors[e],this.sidebar.editMode=!0),this.sidebar.show=!0},removeFloor(){this.$store.dispatch("removeItem",{url:"/floor-types/"+this.selectedFloor.id}).then(()=>{this.alertMessage="Этаж успешно удалён",this.getFloors()}).catch(e=>{this.alertMessage="Не удалось удалить этаж",console.info("Не удалось удалить этаж. Вот почему: ",e.response.data)}),this.closeAlertConfirm()},activateAlertConfirm(e){this.selectedFloor.id=e,this.alertConfirm.isActive=!0},closeAlertConfirm(){this.alertConfirm.isActive=!1},refreshAfterChange(){this.getFloors(),this.closeSidebar()}}},Se={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"house-floors"},[s("div",[s("div",{staticClass:"floors-title"},[e._v("Создайте типовые планировки:")]),e._v(" "),s("div",{staticClass:"floors"},[s("div",{staticClass:"floors-create"},[e._m(0),e._v(" "),s("ButtonDefault",{attrs:{color:"green",name:"Добавить типовой этаж",actionForClick:e.activateSidebar}})],1),e._v(" "),e._l(e.floors,function(t,a){return s("HouseFloorsItem",{key:t.hash_id,attrs:{floorId:t.hash_id,storeIndex:a,image:t.image,floorNumber:t.number,numberOfFlats:t.number_of_flats,markingEnable:t.marking_enable,cloneFloors:t.clone_floors.split(",")},on:{activateSidebar:e.activateSidebar,activateAlertConfirm:e.activateAlertConfirm,emitMarkingFloor:e.markingFloor}})})],2)]),e._v(" "),e.sidebar.show?s("HouseFloorsAdd",{attrs:{houseId:e.houseId,selectedFloor:e.sidebar.selectedFloor,editMode:e.sidebar.editMode,sidebarShow:e.sidebar.show,storeIndex:e.sidebar.storeIndex.toString()},on:{closeSidebar:e.closeSidebar,refreshAfterChange:e.refreshAfterChange}}):e._e(),e._v(" "),e.floorMarking?s("HouseFloorsMarking",{attrs:{currentFloorId:e.selectedFloor.id,numberOfFlats:e.selectedFloor.numberOfFlats},on:{closeMarking:e.closeMarking}}):e._e(),e._v(" "),e.alertMessage?s("AlertDefault",{attrs:{message:e.alertMessage},on:{alertDie:function(t){e.alertMessage=""}}}):e._e(),e._v(" "),e.alertConfirm.isActive?s("AlertConfirm",{attrs:{additionalMessage:e.alertConfirm.additionalMessage},on:{isAgree:e.removeFloor,isDisagree:e.closeAlertConfirm}}):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"floors-create__image"},[t("img",{attrs:{width:"200",height:"200",src:"/static/img/blank_layout.svg"}})])}]};var Fe=s("VU/8")(ye,Se,!1,function(e){s("Yykk")},"data-v-53a98dfc",null).exports,ke={name:"HouseFloors",components:{HouseFloorsList:Fe,HouseContainer:oe,ButtonDefault:f},methods:{getBack(){this.$router.push({name:"HouseFlatsSchemas"})},redirectToNextStep(){this.$router.push({name:"HouseChess"})}}},Ie={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("HouseContainer",[t("HouseFloorsList")],1),this._v(" "),t("div",{staticClass:"house-buttons"},[t("ButtonDefault",{attrs:{name:"Предыдущий шаг",color:"grey",actionForClick:this.getBack}}),this._v(" "),t("ButtonDefault",{attrs:{name:"Следующий шаг",color:"green",actionForClick:this.redirectToNextStep}})],1)],1)},staticRenderFns:[]};var xe=s("VU/8")(ke,Ie,!1,function(e){s("AD22")},"data-v-55b7ff3d",null).exports,Ae={name:"HouseFlatsSchemasAdd",data(){return{type:this.selectedFlatSchema.type||"",flatSchemaId:this.selectedFlatSchema.hash_id||"",area:this.selectedFlatSchema.area||"",numberOfBalcony:this.selectedFlatSchema.number_of_balcony||"",numberOfLoggia:this.selectedFlatSchema.number_of_loggia||"",numberOfRooms:this.selectedFlatSchema.number_of_rooms||"",price:this.selectedFlatSchema.price||"",flatSchemaImage:this.selectedFlatSchema.image||"",imagePreview:"",staticFlatsSchemasTypes:{studio_flat:"Студия",one_room_flat:"Однокомнатная",two_room_flat:"2х-комнатная",three_room_flat:"3х-комнатная",four_room_flat:"4х-комнатная",five_room_flat:"5и-комнатная",euro_two_room_flat:"Евро 2х-комнатная",euro_three_room_flat:"Евро 3х-комнатная"},errorsStack:[]}},props:{storeIndex:String,houseId:{type:String,require:!0},selectedFlatSchema:Object,editMode:{type:Boolean,default:!1},sidebarShow:{type:Boolean,default:!1}},components:{ButtonDefault:f,AlertDefault:O,Sidebar:ce},methods:{closeSidebarToFlatsSchemas(){this.$emit("closeSidebar")},resetImage(){this.flatSchemaImage="",this.imagePreview=""},storeFlatSchema(e="",t="writeItem"){let s=new FormData;const a={house_id:this.houseId,flats_schemas_id:this.flatSchemaId||"",type:this.type,area:this.area,number_of_balcony:this.numberOfBalcony,number_of_rooms:this.numberOfRooms,number_of_loggia:this.numberOfLoggia,price:this.price,image:this.flatSchemaImage};for(let e in a)s.append(e,a[e]);return this.$store.dispatch(t,{fields:s,url:"/flats-schemas"+e,storageName:"houseFlatsSchemas"})},writeFlatSchema(){this.storeFlatSchema().then(()=>{this.$emit("refreshAfterChange")}).catch(e=>{this.errorsStack=e.response.data})},updateFlatSchema(){this.storeFlatSchema("/"+this.selectedFlatSchema.hash_id,"updateItem").then(()=>{this.$emit("refreshAfterChange")}).catch(e=>{this.errorsStack=e.response.data,console.info(e.response.data)})},clearSingleError(){this.$delete(this.errorsStack,"single_error")},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()},processFile(e){this.flatSchemaImage=e.target.files[0];let t=new FileReader;t.onprogress=(e=>{console.info(e)}),t.onloadend=(()=>{this.imagePreview=t.result}),this.flatSchemaImage?t.readAsDataURL(this.flatSchemaImage):this.imagePreview=""}},computed:{singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null},validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e}}},Ee={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.sidebarShow?s("Sidebar",{attrs:{title:"Создание"},on:{closeSidebar:e.closeSidebarToFlatsSchemas}},[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:e.clearSingleError}}):e._e(),e._v(" "),s("div",{staticClass:"login-form"},[e.editMode?s("img",{attrs:{width:"100",height:"100",src:e.flatSchemaImage}}):e._e(),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"type"}},[e._v("Тип квартиры:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.type?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.type)+"\n          ")]):e._e()]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],class:e.validationClass.type,attrs:{type:"flat_schema",name:"type",id:"type"},on:{click:e.clearError,change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.type=t.target.multiple?s:s[0]}}},e._l(e.staticFlatsSchemasTypes,function(t,a){return s("option",{key:a,domProps:{value:a}},[e._v("\n            "+e._s(t)+"\n          ")])}))],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"area"}},[e._v("Типовая площадь:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.area?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.area)+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.area,expression:"area"}],class:e.validationClass.area,attrs:{name:"area",id:"area"},domProps:{value:e.area},on:{click:e.clearError,input:function(t){t.target.composing||(e.area=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_balcony"}},[e._v("Балконы: ")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_balcony?s("span",{staticClass:"form-group__alert"},[e._v("\n          "+e._s(e.errorsStack.number_of_balcony)+"\n        ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.numberOfBalcony,expression:"numberOfBalcony",modifiers:{number:!0}}],class:e.validationClass.number_of_balcony,attrs:{id:"number_of_balcony",name:"number_of_balcony"},domProps:{value:e.numberOfBalcony},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfBalcony=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_rooms"}},[e._v("Количество комнат:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_rooms?s("span",{staticClass:"form-group__alert"},[e._v("\n          "+e._s(e.errorsStack.number_of_rooms)+"\n        ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.numberOfRooms,expression:"numberOfRooms",modifiers:{number:!0}}],class:e.validationClass.number_of_rooms,attrs:{id:"number_of_rooms",name:"number_of_rooms"},domProps:{value:e.numberOfRooms},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfRooms=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_loggia"}},[e._v("Лоджии:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_loggia?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.number_of_loggia)+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.numberOfLoggia,expression:"numberOfLoggia",modifiers:{number:!0}}],class:e.validationClass.number_of_loggia,attrs:{name:"number_of_loggia",id:"number_of_loggia"},domProps:{value:e.numberOfLoggia},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfLoggia=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"price"}},[e._v("Цена:")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.price?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.price)+"\n          ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],class:e.validationClass.price,attrs:{name:"price",id:"price"},domProps:{value:e.price},on:{click:e.clearError,input:function(t){t.target.composing||(e.price=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.image?s("span",{staticClass:"form-group__alert"},[e._v("\n            "+e._s(e.errorsStack.image)+"\n          ")]):e._e()]),e._v("\n        Изображение: "),s("input",{attrs:{name:"image",type:"file"},on:{change:e.processFile}}),e._v(" "),s("button",{attrs:{type:"button"},on:{click:e.resetImage}},[e._v("Х")]),e._v(" "),s("img",{attrs:{width:"200px",height:"200px",src:e.imagePreview}})],1)]),e._v(" "),e.editMode?s("ButtonDefault",{attrs:{name:"Обновить",color:"grey",actionForClick:e.updateFlatSchema}}):s("ButtonDefault",{attrs:{name:"Создать типовую планировку",color:"grey",actionForClick:e.writeFlatSchema}})],1)],1):e._e()},staticRenderFns:[]};var Me=s("VU/8")(Ae,Ee,!1,function(e){s("+OZI")},"data-v-374d360d",null).exports,Ne={name:"HouseFlatsSchemasItem",data:()=>({isVisibleButtons:!1,sidebarShow:!1,staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}}}),props:{flatSchemaId:{type:String,require:!0},image:{type:String,required:!0},type:String,area:{type:String,required:!0},numberOfBalcony:Number,numberOfLoggia:Number,numberOfRooms:Number,editFlatSchemaFunction:Function,storeIndex:Number,price:String},components:{ButtonDefault:f,HouseFlatsSchemasAdd:Me},methods:{toggleEditButton(){this.isVisibleButtons=!this.isVisibleButtons},removeFlatSchema(){this.$emit("activateAlertConfirm",this.flatSchemaId)},editFlatSchema(){this.$emit("activateSidebar",this.storeIndex)}}},De={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"schemas-item",on:{mouseover:e.toggleEditButton,mouseout:e.toggleEditButton}},[s("div",{staticClass:"item-buttons"},[s("a",{attrs:{href:"#make-flats-schemas_container","uk-toggle":""}},[e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-small",attrs:{name:"Редактировать",color:"green",actionForClick:e.editFlatSchema}}):e._e()],1),e._v(" "),e.isVisibleButtons?s("ButtonDefault",{staticClass:"button-small",attrs:{name:"Удалить",color:"red",actionForClick:e.removeFlatSchema}}):e._e()],1),e._v(" "),s("div",{staticClass:"item-image"},[s("img",{attrs:{src:"/static/img"+e.image}})]),e._v(" "),s("div",{staticClass:"item-desc"},[s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Тип квартиры:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.staticFlatsSchemasTypes[e.type].title))])]),e._v(" "),s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Типовая площадь:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.area)+" м"),s("sup",[e._v("2")])])]),e._v(" "),s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Комнат:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.numberOfRooms))])]),e._v(" "),s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Балконы:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.numberOfBalcony))])]),e._v(" "),s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Лоджии:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.numberOfLoggia))])]),e._v(" "),s("div",{staticClass:"item-desc__list"},[s("div",[e._v("Цена:")]),e._v(" "),s("div",{staticClass:"item-desc__list_right"},[e._v(e._s(e.price))])])])])},staticRenderFns:[]};var $e={name:"HouseFlatsSchemasList",data:()=>({houseId:"",selectedFlatSchemaId:"",alertConfirm:{isActive:!1,additionalMessage:"Если вы удалите этот объект, то все данные будут отображаться не корректно"},flatsSchemas:[],sidebar:{show:!1,editMode:!1,selectedFlatSchema:{}},singleErrorMessage:""}),components:{ButtonDefault:f,AlertConfirm:J,AlertDefault:O,HouseFlatsSchemasItem:s("VU/8")(Ne,De,!1,function(e){s("UrBI")},"data-v-1353d172",null).exports,HouseFlatsSchemasAdd:Me},created(){let e=this.$store.state.properties;null!==e&&(this.houseId=JSON.parse(e).hash_id,this.getFlatsSchemas())},methods:{closeSidebar(){Object.assign(this.$data.sidebar,this.$options.data().sidebar)},getBack(){this.$router.push({name:"HouseProperties",params:{houseStoreIndex:this.storeIndex}})},getFlatsSchemas(){return this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId+"/flats-schemas",storageName:"flatsSchemas"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"flatsSchemas",fields:e.data}).then(()=>{this.flatsSchemas=JSON.parse(e.data)}).catch(e=>{this.singleErrorMessage="Не могу получить список планировок. Обратитесь к администратору.",console.info(e.response.data),setTimeout(function(){this.singleErrorMessage=""},3e3)})})},activateSidebar(e){void 0!==e&&(this.sidebar.selectedFlatSchema=this.flatsSchemas[e].fields,this.sidebar.editMode=!0),this.sidebar.show=!0},removeFlatSchema(){this.$store.dispatch("removeItem",{url:"/flats-schemas/"+this.selectedFlatSchemaId}).then(()=>{this.refreshAfterChange()}).catch(()=>{this.singleErrorMessage="Не получилось удалить планировку"}),this.closeAlertConfirm()},activateAlertConfirm(e){this.selectedFlatSchemaId=e,this.alertConfirm.isActive=!0},refreshAfterChange(){this.alertConfirm.isActive=!1,this.getFlatsSchemas(),this.closeSidebar()},closeAlertConfirm(){this.alertConfirm.isActive=!1}}},Be={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flats-schemas"},[s("div",[s("div",{staticClass:"schemas-title"},[e._v("Создайте типовые планировки:")]),e._v(" "),s("div",{staticClass:"schemas"},[s("div",{staticClass:"schemas-create"},[e._m(0),e._v(" "),s("ButtonDefault",{attrs:{color:"green",name:"Добавить планировку",actionForClick:e.activateSidebar}})],1),e._v(" "),e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),e._l(e.flatsSchemas,function(t,a){return s("HouseFlatsSchemasItem",{key:t.fields.hash_id,attrs:{flatSchemaId:t.fields.hash_id,storeIndex:a,image:t.fields.image,type:t.fields.type,area:t.fields.area,numberOfBalcony:t.fields.number_of_balcony,numberOfLoggia:t.fields.number_of_loggia,numberOfRooms:t.fields.number_of_rooms,price:t.fields.price},on:{activateSidebar:e.activateSidebar,activateAlertConfirm:e.activateAlertConfirm}})})],2)]),e._v(" "),e.sidebar.show?s("HouseFlatsSchemasAdd",{attrs:{houseId:e.houseId,selectedFlatSchema:e.sidebar.selectedFlatSchema,editMode:e.sidebar.editMode,sidebarShow:e.sidebar.show},on:{closeSidebar:e.closeSidebar,refreshAfterChange:e.refreshAfterChange}}):e._e(),e._v(" "),e.alertConfirm.isActive?s("AlertConfirm",{attrs:{additionalMessage:e.alertConfirm.additionalMessage},on:{isAgree:e.removeFlatSchema,isDisagree:e.closeAlertConfirm}}):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"schemas-create__image"},[t("img",{attrs:{width:"200",height:"200",src:"/static/img/blank_layout.svg"}})])}]};var He=s("VU/8")($e,Be,!1,function(e){s("TvdI")},"data-v-71e054d9",null).exports,Pe={name:"HouseFlatsSchemas",data:()=>({alertMessage:""}),components:{AlertDefault:O,ButtonDefault:f,HouseContainer:oe,HouseFlatsSchemasList:He},methods:{getBack(){this.$router.push({name:"HouseProperties",params:{houseStoreIndex:this.storeIndex}})},redirectToNextStep(){this.$store.state.flatsSchemas?this.$router.push({name:"HouseFloors",params:{houseStoreIndex:this.storeIndex}}):this.alertMessage="Вы не создали ни одной планировки"}}},Oe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("HouseContainer",[s("HouseFlatsSchemasList")],1),e._v(" "),s("div",{staticClass:"house-buttons"},[s("ButtonDefault",{attrs:{name:"Предыдущий шаг",color:"grey",actionForClick:e.getBack}}),e._v(" "),s("ButtonDefault",{attrs:{name:"Следующий шаг",color:"green",actionForClick:e.redirectToNextStep}}),e._v(" "),e.alertMessage?s("AlertDefault",{attrs:{message:e.alertMessage}}):e._e()],1)],1)},staticRenderFns:[]};var Te=s("VU/8")(Pe,Oe,!1,function(e){s("Gt7D")},"data-v-65e800e0",null).exports,Ve=s("GAw7"),Re={name:"HouseProperties",components:{ButtonDefault:f,HouseContainer:oe,DraggableCal:s.n(Ve).a,AlertDefault:O},data:()=>({houseId:"",buildingId:"",pluginDate:"",materials:[],numberOfFloors:null,livingFloorsStart:"",livingFloorsEnd:"",numberOfEntrance:null,numberOfFlat:null,streetName:"",number:"",finishing:"",stageDevelopment:"",startDevelopment:{calendarIsActive:!1,value:""},endDevelopment:{calendarIsActive:!1,value:""},errorsStack:[],editMode:!1}),created(){this.houseId=this.$store.state.currentHouseId,void 0!==this.houseId&&this.getProperties().then(e=>{this.editMode=!0,this.fillHouseProperties(e.data)});let e=this.$store.state.currentBuildingStoreIndex;this.buildingId=JSON.parse(this.$store.state.buildings)[e].building.hash_id},methods:{createStrDateFromObject(e){let t=[e.getDate(),e.getMonth()+1,e.getFullYear()];for(let e in t)t[e]=t[e].toString().replace(/^([0-9])$/,"0$1");let s=t[0]+"."+t[1]+"."+t[2];return console.info(s),s},dateSelected(e,t){e.value=this.createStrDateFromObject(t),setTimeout(function(){e.calendarIsActive=!1},600)},reformatDate(e,t){let s="-",a=".";if(t){let e=a;a=s,s=e}let r=e.split(s),i=r[2]+a+r[1]+a+r[0];return console.info(i),i},getProperties(){return this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId,storageName:"properties"})},fillHouseProperties(e){let t=e.living_floors.split(",");this.houseId=e.hash_id,this.buildingId=e.building_hash_id,this.materials=e.materials.split(","),this.numberOfFloors=e.number_of_floors,this.livingFloorsStart=t[0],this.livingFloorsEnd=t[1],this.numberOfEntrance=e.number_of_entrance,this.numberOfFlat=e.number_of_flat,this.streetName=e.street_name,this.number=e.number,this.finishing=e.finishing,this.stageDevelopment=e.stage_development,this.startDevelopment.value=this.reformatDate(e.start_development),this.endDevelopment.value=this.reformatDate(e.end_development)},createHouseProperties(){this.storeHouseProperties().then(e=>{this.$store.dispatch("setItemToStore",{storageName:"properties",fields:JSON.stringify(e.data)}),this.$store.dispatch("setItemToStore",{storageName:"currentHouseId",fields:e.data.hash_id}),this.$router.push({name:"HouseFlatsSchemas"})}).catch(e=>{this.errorsStack=e.response.data})},updateHouseProperties(){this.storeHouseProperties("/"+this.houseId,"updateItem").then(()=>{this.$router.push({name:"BuildingMain"})}).catch(e=>{this.errorsStack=e.response.data})},skipStep(){this.$router.push({name:"HouseFlatsSchemas"})},storeHouseProperties(e="",t="writeItem"){const s={building_id:this.buildingId,materials:this.materials.join(",").trim(),number_of_floors:this.numberOfFloors,living_floors:this.livingFloors,number_of_entrance:this.numberOfEntrance,number_of_flat:this.numberOfFlat,street_name:this.streetName,number:this.number,finishing:this.finishing,stage_development:this.stageDevelopment,start_development:this.reformatDate(this.startDevelopment.value,!0),end_development:this.reformatDate(this.endDevelopment.value,!0)};return this.$store.dispatch(t,{fields:s,url:"/houses"+e,storageName:"properties"})},clearSingleError(){this.$delete(this.errorsStack,"single_error")},clearError(e){let t=e.target.id;this.$delete(this.errorsStack,t),this.clearSingleError()}},computed:{validationClass(){let e={};for(let t in this.errorsStack)e[t]="error";return e},singleErrorMessage(){return this.errorsStack.single_error?this.errorsStack.message:null},livingFloors(){return this.livingFloorsStart+","+this.livingFloorsEnd}}},Ue={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("HouseContainer",[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"house-properties"},[s("div",{staticClass:"properties"},[s("div",{staticClass:"properties-characteristics"},[s("div",{staticClass:"characteristics-title"},[e._v("Введите характеристики дома:")]),e._v(" "),s("div",{staticClass:"characteristics-grid"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_floors"}},[e._v("Всего этажей")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_floors?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.number_of_floors)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.numberOfFloors,expression:"numberOfFloors"}],class:e.validationClass.number_of_floors,attrs:{type:"text",id:"number_of_floors"},domProps:{value:e.numberOfFloors},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfFloors=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"living_floors"}},[e._v("С")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.livingFloorsStart?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.living_floors)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.livingFloorsStart,expression:"livingFloorsStart"}],class:e.validationClass.living_floors,attrs:{type:"text",id:"living_floors",name:"living_floors"},domProps:{value:e.livingFloorsStart},on:{click:e.clearError,input:function(t){t.target.composing||(e.livingFloorsStart=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"livingFloorsEnd"}},[e._v("По")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.living_floors?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.living_floors)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.livingFloorsEnd,expression:"livingFloorsEnd"}],class:e.validationClass.number_of_floors,attrs:{type:"text",id:"livingFloorsEnd",name:"livingFloorsEnd"},domProps:{value:e.livingFloorsEnd},on:{click:e.clearError,input:function(t){t.target.composing||(e.livingFloorsEnd=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_entrance"}},[e._v("Подъездов")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_entrance?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.number_of_entrance)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.numberOfEntrance,expression:"numberOfEntrance"}],class:e.validationClass.number_of_entrance,attrs:{type:"text",id:"number_of_entrance"},domProps:{value:e.numberOfEntrance},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfEntrance=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number_of_flat"}},[e._v("Квартир")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number_of_flat?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.number_of_flat)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.numberOfFlat,expression:"numberOfFlat"}],class:e.validationClass.number_of_flat,attrs:{type:"text",id:"number_of_flat"},domProps:{value:e.numberOfFlat},on:{click:e.clearError,input:function(t){t.target.composing||(e.numberOfFlat=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"streetName"}},[e._v("Улица")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.street_name?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.street_name)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.streetName,expression:"streetName"}],class:e.validationClass.street_name,attrs:{type:"text",id:"street_name",name:"street_name"},domProps:{value:e.streetName},on:{click:e.clearError,input:function(t){t.target.composing||(e.streetName=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"number"}},[e._v("№ дома")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.number?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.number)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.number,expression:"number"}],class:e.validationClass.number,attrs:{type:"text",id:"number"},domProps:{value:e.number},on:{click:e.clearError,input:function(t){t.target.composing||(e.number=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"finishing"}},[e._v("Отделка")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.finishing?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.finishing)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.finishing,expression:"finishing"}],class:e.validationClass.finishing,attrs:{type:"text",id:"finishing"},domProps:{value:e.finishing},on:{click:e.clearError,input:function(t){t.target.composing||(e.finishing=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"stage_development"}},[e._v("Этап строительства")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("transition",{attrs:{name:"slide-fade"}},[e.errorsStack.stage_development?s("span",{staticClass:"form-group__alert"},[e._v("\n                    "+e._s(e.errorsStack.stage_development)+"\n                  ")]):e._e()]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.stageDevelopment,expression:"stageDevelopment"}],class:e.validationClass.stage_development,attrs:{type:"text",id:"stageDevelopment"},domProps:{value:e.stageDevelopment},on:{click:e.clearError,input:function(t){t.target.composing||(e.stageDevelopment=t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"})],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"startDevelopment"}},[e._v("Начало строительства")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.startDevelopment.value,expression:"startDevelopment.value"}],attrs:{type:"text",id:"startDevelopment"},domProps:{value:e.startDevelopment.value},on:{click:function(t){e.startDevelopment.calendarIsActive=!e.startDevelopment.calendarIsActive},input:function(t){t.target.composing||e.$set(e.startDevelopment,"value",t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"}),e._v(" "),e.startDevelopment.calendarIsActive?s("DraggableCal",{staticClass:"characteristics-cal",attrs:{days:Number(1095)},on:{dateSelected:function(t){e.dateSelected(e.startDevelopment,t)}}}):e._e()],1)]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-group__label",attrs:{for:"endDevelopment"}},[e._v("Конец строительства")]),e._v(" "),s("div",{staticClass:"form-group__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.endDevelopment.value,expression:"endDevelopment.value"}],attrs:{type:"text",id:"endDevelopment"},domProps:{value:e.endDevelopment.value},on:{click:function(t){e.endDevelopment.calendarIsActive=!e.endDevelopment.calendarIsActive},input:function(t){t.target.composing||e.$set(e.endDevelopment,"value",t.target.value)}}}),e._v(" "),s("span",{staticClass:"form-group__input_bar"}),e._v(" "),e.endDevelopment.calendarIsActive?s("DraggableCal",{staticClass:"characteristics-cal",attrs:{days:Number(1095)},on:{dateSelected:function(t){e.dateSelected(e.endDevelopment,t)}}}):e._e()],1)])])]),e._v(" "),s("div",{staticClass:"properties-finishing"},[s("div",{staticClass:"finishing-title"},[e._v("Отделка:")]),e._v(" "),s("div",{staticClass:"finishing-grid"},[s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.materials,expression:"materials"}],attrs:{type:"checkbox",id:"without_finishing",value:"Стройвариант"},domProps:{checked:Array.isArray(e.materials)?e._i(e.materials,"Стройвариант")>-1:e.materials},on:{change:function(t){var s=e.materials,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i="Стройвариант",o=e._i(s,i);a.checked?o<0&&(e.materials=s.concat([i])):o>-1&&(e.materials=s.slice(0,o).concat(s.slice(o+1)))}else e.materials=r}}}),e._v(" "),s("label",{attrs:{for:"without_finishing"}},[e._v("Стройвариант")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.materials,expression:"materials"}],attrs:{type:"checkbox",id:"rough_finishing",value:"Черновая"},domProps:{checked:Array.isArray(e.materials)?e._i(e.materials,"Черновая")>-1:e.materials},on:{change:function(t){var s=e.materials,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Черновая");a.checked?i<0&&(e.materials=s.concat(["Черновая"])):i>-1&&(e.materials=s.slice(0,i).concat(s.slice(i+1)))}else e.materials=r}}}),e._v(" "),s("label",{attrs:{for:"rough_finishing"}},[e._v("Черновая")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.materials,expression:"materials"}],attrs:{type:"checkbox",id:"prefinishing_finishing",value:"Предчистовая"},domProps:{checked:Array.isArray(e.materials)?e._i(e.materials,"Предчистовая")>-1:e.materials},on:{change:function(t){var s=e.materials,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i="Предчистовая",o=e._i(s,i);a.checked?o<0&&(e.materials=s.concat([i])):o>-1&&(e.materials=s.slice(0,o).concat(s.slice(o+1)))}else e.materials=r}}}),e._v(" "),s("label",{attrs:{for:"prefinishing_finishing"}},[e._v("Предчистовая")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.materials,expression:"materials"}],attrs:{type:"checkbox",id:"finishing_finishing",value:"Чистовая"},domProps:{checked:Array.isArray(e.materials)?e._i(e.materials,"Чистовая")>-1:e.materials},on:{change:function(t){var s=e.materials,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"Чистовая");a.checked?i<0&&(e.materials=s.concat(["Чистовая"])):i>-1&&(e.materials=s.slice(0,i).concat(s.slice(i+1)))}else e.materials=r}}}),e._v(" "),s("label",{attrs:{for:"finishing_finishing"}},[e._v("Чистовая")])]),e._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.materials,expression:"materials"}],attrs:{type:"checkbox",id:"with_repair",value:"С ремонтом"},domProps:{checked:Array.isArray(e.materials)?e._i(e.materials,"С ремонтом")>-1:e.materials},on:{change:function(t){var s=e.materials,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i="С ремонтом",o=e._i(s,i);a.checked?o<0&&(e.materials=s.concat([i])):o>-1&&(e.materials=s.slice(0,o).concat(s.slice(o+1)))}else e.materials=r}}}),e._v(" "),s("label",{attrs:{for:"with_repair"}},[e._v("С ремонтом")])])])]),e._v(" "),s("div",{staticClass:"properties-buttons"},[e.editMode?s("div",[s("ButtonDefault",{attrs:{name:"Обновить",color:"green",actionForClick:e.updateHouseProperties}}),e._v(" "),s("ButtonDefault",{attrs:{name:"Пропустить",color:"green",actionForClick:e.skipStep}})],1):s("ButtonDefault",{attrs:{name:"Следующий шаг",color:"green",actionForClick:e.createHouseProperties}})],1)])])],1)],1)},staticRenderFns:[]};var Le=s("VU/8")(Re,Ue,!1,function(e){s("BhWB")},"data-v-127a539b",null).exports,qe={name:"HousePricesFlat",data(){return{statusList:{0:"Забронирована",1:"Свободна"},staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},newArea:this.area,newPrice:this.price,newStatus:this.status,editableValue:null}},props:{number:{type:Number,required:!0},flatId:{type:String,required:!0},flatSchema:{type:String,required:!0},area:{type:String,required:!0},price:{type:Number,required:!0},entrance:{type:Number,required:!0},status:{type:Number,required:!0}},methods:{updateFlat(){if(this.oldValuesWasChanged){let e={status:this.newStatus,price:this.newPrice,area:this.newArea};this.$store.dispatch("updateItem",{url:"/flats/"+this.flatId,fields:e}),e.flatId=this.flatId,this.$emit("updateFlatsList",e)}}},computed:{oldValuesWasChanged(){return this.area!==this.newArea||this.price!==this.newPrice||this.status!==this.newStatus}}},We={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table-item"},[s("div",{staticClass:"table-item__title"},[e._v("Квартира "),s("span",[e._v("№"+e._s(e.number))])]),e._v(" "),s("span",[e._v(e._s(e.staticFlatsSchemasTypes[e.flatSchema].title))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newArea,expression:"newArea"}],attrs:{name:"area",id:"area"},domProps:{value:e.newArea},on:{blur:e.updateFlat,input:function(t){t.target.composing||(e.newArea=t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPrice,expression:"newPrice"}],attrs:{name:"price",id:"price"},domProps:{value:e.newPrice},on:{blur:e.updateFlat,input:function(t){t.target.composing||(e.newPrice=t.target.value)}}}),e._v(" "),s("span",[e._v(e._s(e.entrance))]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.newStatus,expression:"newStatus"}],on:{blur:e.updateFlat,change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.newStatus=t.target.multiple?s:s[0]}}},e._l(e.statusList,function(t,a){return s("option",{key:a,domProps:{value:a}},[e._v(e._s(t))])}))])},staticRenderFns:[]};var je=s("VU/8")(qe,We,!1,function(e){s("sSMq")},"data-v-b074b966",null).exports,Je={name:"HousePricesFloor",data:()=>({alertShow:!1,selectedFloor:[],floorNumber:""}),props:{floor:{type:Array,required:!0},floorIndex:Number,editableFloorIndex:Number},components:{AlertConfirm:J,ButtonDefault:f,HousePricesFlat:je},created(){this.floorNumber=this.floor[0].floor},methods:{alertConfirm(){this.alertShow=!0},editFloor(){this.editMode||this.$emit("editFloor",this.floorIndex)},updateFlatsList(e){this.$emit("updateFlatsList",e)}},computed:{editMode(){return this.editableFloorIndex===this.floorIndex}}},Ge={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"house-pricesfloor",class:e.floorIndex,on:{click:e.editFloor}},[s("div",{staticClass:"pricesfloor-info"},[s("div",{staticClass:"info-title"},[e._v("Этаж "+e._s(e.floorNumber))]),e._v(" "),e.editMode?s("div",{staticClass:"info-num"},[e._v(e._s(e.floorNumber))]):e._e()]),e._v(" "),s("transition",[e.editMode?s("div",{staticClass:"pricesfloor-table"},[s("div",{staticClass:"table-header"},[s("div",[e._v("Номер квартиры")]),e._v(" "),s("div",[e._v("Планировка")]),e._v(" "),s("div",[e._v("Площадь")]),e._v(" "),s("div",[e._v("Цена")]),e._v(" "),s("div",[e._v("Подъезд")]),e._v(" "),s("div",[e._v("Статус")])]),e._v(" "),e._l(e.floor,function(t,a){return[s("HousePricesFlat",{key:a,attrs:{number:t.number,flatId:t.hash_id,flatSchema:t.flat_schema,area:t.area,price:Number(t.price),entrance:t.entrance,status:t.status},on:{updateFlatsList:e.updateFlatsList}})]})],2):e._e()])],1)},staticRenderFns:[]};var Ke={name:"HousePrices",data:()=>({fullHouse:[],editableFloorIndex:null,singleErrorMessage:"",staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},expandFloors:!1}),components:{ButtonDefault:f,AlertDefault:O,HouseContainer:oe,HousePricesFloor:s("VU/8")(Je,Ge,!1,function(e){s("pyqm")},"data-v-378cd3a4",null).exports},created(){let e=this.$store.state.fullHouse;null===e?this.getFullHouse():this.fullHouse=JSON.parse(e)},methods:{getFullHouse(){let e=this.$store.state.currentHouseId;this.$store.dispatch("retrieveItem",{url:"/houses/"+e+"/flats",storageName:"fullHouse"}).then(e=>{this.fullHouse=e.data.flats}).catch(e=>{this.singleErrorMessage="Не могу получить информацию о доме.",console.info(this.singleErrorMessage+"Вот почему: ",e.response.data)})},dataImport(){alert("Импорт цен")},editFloor(e){this.editableFloorIndex=e}}},Ye={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("HouseContainer",[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"house-prices"},[s("div",{staticClass:"prices-header"},[s("div",{staticClass:"header-title"},[e._v("Введите цену и площадь квартир")]),e._v(" "),s("div",{staticClass:"header-filter"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.expandFloors,expression:"expandFloors"}],attrs:{type:"checkbox",id:"expandFloorToggle"},domProps:{checked:Array.isArray(e.expandFloors)?e._i(e.expandFloors,null)>-1:e.expandFloors},on:{change:function(t){var s=e.expandFloors,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,null);a.checked?i<0&&(e.expandFloors=s.concat([null])):i>-1&&(e.expandFloors=s.slice(0,i).concat(s.slice(i+1)))}else e.expandFloors=r}}}),e._v(" "),s("label",{attrs:{for:"expandFloorToggle"}},[e._v("Развернуть все этажи")])])]),e._v(" "),s("div",{staticClass:"flats_list"},[e._l(e.fullHouse,function(t,a){return[s("HousePricesFloor",{key:a,attrs:{floor:t,floorIndex:a,editableFloorIndex:e.editableFloorIndex},on:{editFloor:e.editFloor,updateFlatsList:e.getFullHouse}})]})],2)])],1)],1)},staticRenderFns:[]};var Xe=s("VU/8")(Ke,Ye,!1,function(e){s("ygbr")},"data-v-fe7c4604",null).exports,ze={name:"HouseChessBase",data:()=>({roomsView:!0,singleErrorMessage:"",flats:{},staticFlatsSchemasTypes:{studio_flat:{title:"Студия",alias:"S"},one_room_flat:{title:"Однокомнатная",alias:"1к"},two_room_flat:{title:"2х-комнатная",alias:"2х"},three_room_flat:{title:"3х-комнатная",alias:"3х"},four_room_flat:{title:"4х-комнатная",alias:"4х"},five_room_flat:{title:"5и-комнатная",alias:"5к"},euro_two_room_flat:{title:"Евро 2х-комнатная",alias:"Е2"},euro_three_room_flat:{title:"Евро 3х-комнатная",alias:"Е3"}},flatTypes:{}}),components:{AlertDefault:O},created(){this.houseId=this.$store.state.currentHouseId,this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId+"/flats"}).then(e=>{this.flats=e.data.flats,this.flatTypes=e.data.number_of_flats_by_type}).catch(e=>{this.singleErrorMessage="Не могу получить список квартир. Обратитесь к администратору.",console.info("Не получил список квартир. Вот почему: ",e.response.data)})},methods:{getFlatsSchemas(){return this.$store.dispatch("retrieveItem",{url:"/houses/"+this.houseId+"/flats-schemas",storageName:"flatsSchemas"}).then(e=>{this.$store.dispatch("setItemToStore",{storageName:"flatsSchemas",fields:e.data}).then(()=>{this.flatsSchemas=JSON.parse(e.data)}).catch(e=>{console.info("Не удалось получить планировки. Вот почему: ",e.response.data)})})}},computed:{numberOfFloors(){let e=0;return Array.from(this.flats).map(()=>{e++}),e}}},Qe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"house-chessbase"},[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"chessbase-info"},[s("div",{staticClass:"info-title"},[e._v("Проверьте правильность нумерации квартир и приступите к последнему шагу")]),e._v(" "),s("div",{staticClass:"info-desc"},[e._v("При необходимости вернитесь на предыдущий шаг для внесения правок")]),e._v(" "),s("div",{staticClass:"info-list"},e._l(e.flatTypes,function(t,a){return s("div",{key:a,staticClass:"list-flat"},[s("div",{staticClass:"list-flat__type"},[e._v(e._s(e.staticFlatsSchemasTypes[t.type].alias))]),e._v(" "),s("div",{staticClass:"list-flat__desc"},[e._v(e._s(e.staticFlatsSchemasTypes[t.type].title))]),e._v(" "),s("div",{staticClass:"list-flat__amount"},[e._v(e._s(t.number_of))])])}))]),e._v(" "),s("div",{staticClass:"chessbase-masonry"},[s("div",{staticClass:"masonry-header"},[s("div",{staticClass:"header-title"},[e._v("Шахматка")]),e._v(" "),s("div",{staticClass:"header-filter"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roomsView,expression:"roomsView"}],attrs:{type:"checkbox",id:"rooms",value:"rooms"},domProps:{checked:Array.isArray(e.roomsView)?e._i(e.roomsView,"rooms")>-1:e.roomsView},on:{change:function(t){var s=e.roomsView,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=e._i(s,"rooms");a.checked?i<0&&(e.roomsView=s.concat(["rooms"])):i>-1&&(e.roomsView=s.slice(0,i).concat(s.slice(i+1)))}else e.roomsView=r}}}),e._v(" "),s("label",{attrs:{for:"rooms"}},[e._v("Комнатность")])])]),e._v(" "),s("div",{staticClass:"masonry-chess"},[e._m(0),e._v(" "),e._l(e.flats.slice().reverse(),function(t,a){return s("div",{key:a,staticClass:"chess-floor",attrs:{floor:t[0].floor}},[s("div",{staticClass:"floor-num"},[e._v("\n          "+e._s(t[0].floor)+"\n        ")]),e._v(" "),s("div",{staticClass:"floor-flats"},e._l(t,function(t,a){return s("div",{key:a,staticClass:"floor-flat"},[e.roomsView?s("div",{staticClass:"floor-flat__numb"},[e._v(e._s(t.number))]):s("div",{staticClass:"floor-flat__numb"},[e._v(e._s(t.number_of_rooms))])])})),e._v(" "),s("div",{staticClass:"floor-num"},[e._v("\n          "+e._s(t[0].floor)+"\n        ")])])})],2)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"chess-header"},[t("div",[this._v("Этажи")]),this._v(" "),t("div",[this._v("Подъезды ")]),this._v(" "),t("div",[this._v("Этажи")])])}]};var Ze=s("VU/8")(ze,Qe,!1,function(e){s("yh5A")},"data-v-945243b4",null).exports,et={name:"HouseChess",components:{HouseContainer:oe,HouseChessBase:Ze}},tt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("HouseContainer",[t("HouseChessBase")],1)},staticRenderFns:[]};var st=s("VU/8")(et,tt,!1,function(e){s("uVed")},"data-v-05a6af0c",null).exports,at={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"house-main"},[s("router-link",{attrs:{to:{name:"BuildingMain"}}},[e._v("Жилой комплекс")]),e._v(" "),s("div",{staticClass:"main-nav"},[s("router-link",{staticClass:"nav-item",attrs:{to:{name:"HouseMainProperties"}}},[e._v("Характеристики"),s("br"),e._v("дома")]),e._v(" "),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"HouseMainChess"}}},[e._v("Шахматка")]),e._v(" "),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"HouseMainFlatsSchemas"}}},[e._v("Типовые"),s("br"),e._v("планровки")]),e._v(" "),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"HouseMainFloors"}}},[e._v("Типовые"),s("br"),e._v("этажи")]),e._v(" "),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"HouseMainFacades"}}},[e._v("Фасады")])],1)],1),e._v(" "),e._t("default")],2)},staticRenderFns:[]};var rt=s("VU/8")({name:"HouseMain"},at,!1,function(e){s("GFzu")},"data-v-7726438d",null).exports,it={name:"HouseMainProperties",data:()=>({houseId:"",buildingId:"",materials:[],numberOfFloors:null,livingFloors:"",numberOfEntrance:null,numberOfFlats:null,streetName:"",number:"",finishing:"",stageDevelopment:"",startDevelopment:"",singleErrorMessage:"",endDevelopment:"",editMode:!1}),components:{AlertDefault:O,HouseMain:rt},created(){this.$store.dispatch("retrieveItem",{url:"/houses/"+this.$store.state.currentHouseId,storageName:"properties"}).then(e=>{this.fillHouseProperties(e.data),this.$store.dispatch("setItemToStore",{storageName:"properties",fields:JSON.stringify(e.data)})}).catch(e=>{this.singleErrorMessage="Не удалось получить характеристики дома.",console.info(e.response.data)})},methods:{fillHouseProperties(e){this.houseId=e.hash_id,this.buildingId=e.building_hash_id,this.materials=e.materials.split(","),this.numberOfFloors=e.number_of_floors,this.livingFloors=e.living_floors,this.numberOfEntrance=e.number_of_entrance,this.numberOfFlats=e.number_of_flat,this.streetName=e.street_name,this.number=e.number,this.finishing=e.finishing.split(","),this.stageDevelopment=e.stage_development,this.startDevelopment=e.start_development,this.endDevelopment=e.end_development}}},ot={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("HouseMain",[s("div",{staticClass:"house-mainproperties"},[s("div",{staticClass:"properties-info"},[e.singleErrorMessage?s("AlertDefault",{attrs:{message:e.singleErrorMessage},on:{alertDie:function(t){e.singleErrorMessage=""}}}):e._e(),e._v(" "),s("div",{staticClass:"info-header"},[s("div",{staticClass:"header-title"},[e._v("Характеристики дома")]),e._v(" "),s("div",{staticClass:"header-edit"})]),e._v(" "),s("div",{staticClass:"info-list"},[s("div",{staticClass:"info-list__column"},[s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Всего"),s("br"),e._v("этажей:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.numberOfFloors))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Жилых"),s("br"),e._v("этажей:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.livingFloors))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Количество"),s("br"),e._v("подъездов:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.numberOfEntrance))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Количество"),s("br"),e._v("квартир:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.numberOfFlats))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Номер"),s("br"),e._v("дома:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.number))])])]),e._v(" "),s("div",{staticClass:"info-list__column"},[s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Стадия"),s("br"),e._v("строительства:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.stageDevelopment))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Начало"),s("br"),e._v("строительства:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.startDevelopment))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Окончание"),s("br"),e._v("строительства:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.endDevelopment))])]),e._v(" "),s("div",{staticClass:"list-item"},[s("span",{staticClass:"list-item__title"},[e._v("Улица:")]),e._v(" "),s("span",{staticClass:"list-item__value"},[e._v(e._s(e.streetName))])])])]),e._v(" "),s("div",{staticClass:"info-materials"},[s("div",[s("div",[e._v("Отделка квартир:\n              "),e._l(e.finishing,function(t,a){return s("span",{key:a},[e._v("\n                "+e._s(t)+"\n              ")])})],2)]),e._v(" "),s("div",[s("div",[e._v("Материалы:\n              "),e._l(e.materials,function(t,a){return s("span",{key:a},[e._v("\n                "+e._s(t)+"\n              ")])})],2)])])],1),e._v(" "),s("div",{staticClass:"properties-media"},[e._v("\n      1\n    ")])])])},staticRenderFns:[]};var nt=s("VU/8")(it,ot,!1,function(e){s("gWyR")},"data-v-183fe4dc",null).exports,lt={name:"HouseMainFlatsSchemas",components:{HouseMain:rt,HouseFlatsSchemasList:He}},ct={render:function(){var e=this.$createElement,t=this._self._c||e;return t("HouseMain",[t("HouseFlatsSchemasList")],1)},staticRenderFns:[]};var dt=s("VU/8")(lt,ct,!1,function(e){s("G298")},"data-v-0a964596",null).exports,ut={name:"HouseMainFloors",components:{HouseMain:rt,HouseFloorsList:Fe}},mt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("HouseMain",[t("HouseFloorsList")],1)},staticRenderFns:[]};var _t=s("VU/8")(ut,mt,!1,function(e){s("XnBX")},"data-v-02b7f79c",null).exports,vt={name:"HouseMainChess",components:{HouseChessBase:Ze,HouseMain:rt}},pt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("HouseMain",[t("HouseChessBase")],1)},staticRenderFns:[]};var ht=s("VU/8")(vt,pt,!1,function(e){s("7gnl")},"data-v-61892c58",null).exports,ft={name:"HouseMainFacades",components:{HouseMain:rt}},gt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("HouseMain",[t("div",[this._v("\n    FACADE\n  ")])])},staticRenderFns:[]};var bt=s("VU/8")(ft,gt,!1,function(e){s("Smr4")},"data-v-bfa44a28",null).exports,Ct=s("NYxO");a.a.use(Ct.a),a.a.prototype.$rootUrl="http://172.100.114.2:8000";const wt=a.a.prototype.$rootUrl,yt=new Ct.a.Store({state:{apiKey:localStorage.getItem("apiKey")||null,companyHashId:localStorage.getItem("companyHashId")||null,buildings:localStorage.getItem("buildings")||null,currentHouseId:localStorage.getItem("currentHouseId")||null,houseFloors:localStorage.getItem("houseFloors")||null,fullHouse:localStorage.getItem("fullHouse")||null,properties:localStorage.getItem("properties")||null,flatsSchemas:localStorage.getItem("flatsSchemas")||null,currentBuildingStoreIndex:localStorage.getItem("currentBuildingStoreIndex")||null,currentHouseStoreIndex:localStorage.getItem("currentHouseStoreIndex")||null},getters:{loggedIn:e=>null!=e.apiKey},mutations:{set(e,{type:t,items:s}){e[t]=s},storeItem(e,t){e[t.name]=t.fields},destroyItem(e,t){e[t]=null},retrieveAuthData(e,t){e.apiKey=t.apiKey,e.companyHashId=t.companyHashId},destroyAuthData(e){e.apiKey=null,e.companyHashId=null}},actions:{setItemToStore(e,t){localStorage.setItem(t.storageName,t.fields),e.commit("storeItem",{name:t.storageName,fields:t.fields})},destroyItemFromStore(e,t){localStorage.removeItem(t),e.commit("destroyItem",t)},writeItem:(e,t)=>new Promise((s,a)=>{t.fields.api_key=e.state.apiKey,M({url:wt+t.url,method:"POST",data:t.fields,headers:{"Content-type":"multipart/form-data"}}).then(e=>{s(e)}).catch(e=>{a(e)})}),updateItem:(e,t)=>new Promise((s,a)=>{t.fields.api_key=e.state.apiKey,M({url:wt+t.url,method:"PUT",data:t.fields,headers:{"Content-type":"multipart/form-data"}}).then(e=>{s(e)}).catch(e=>{a(e)})}),removeItem:(e,t)=>new Promise((e,s)=>{M({url:wt+t.url,method:"DELETE",data:t.fields,headers:{"Content-type":"multipart/form-data"}}).then(t=>{e(t)}).catch(e=>{s(e)})}),retrieveItem:(e,t)=>new Promise((s,a)=>{M({url:wt+t.url,method:"GET",params:{api_key:e.state.apiKey},headers:{"Content-type":"multipart/form-data"}}).then(e=>{s(e)}).catch(e=>{a(e)})}),storeLoginData(e,t){for(let e in t)localStorage.setItem(e,t[e]);e.commit("retrieveAuthData",t)},retrieveAuthData:(e,t)=>new Promise((e,s)=>{let a=JSON.stringify({email:t.email,password:t.password});M.post(wt+"/login",a).then(t=>{yt.dispatch("storeLoginData",{apiKey:t.data.api_key,companyHashId:t.data.company_hash_id}),e(t)}).catch(e=>{s(e)})}),destroyApiKey(e){if(e.getters.loggedIn)return new Promise((t,s)=>{let a=JSON.stringify({api_key:this.state.apiKey,company_hash_id:this.state.companyHashId});M.post(wt+"/logout",a).then(s=>{e.commit("destroyAuthData"),localStorage.clear(),t(s)}).catch(e=>{s(e)})})},registerUser:(e,t)=>new Promise((e,s)=>{M.post(wt+"/register",t).then(t=>{e(t)}).catch(e=>{s(e)})})}});var St=yt;a.a.use(c.a);const Ft=(e,t,s)=>{St.getters.loggedIn?s():s("login")};var kt=new c.a({routes:[{path:"/register",name:"Register",component:C},{path:"/login",name:"Login",component:S},{path:"/password/email",name:"PasswordEmail",component:E},{path:"/password/reset/:password_code",name:"PasswordReset",component:B},{path:"/logout",name:"Logout",component:R},{path:"/",name:"Buildings",component:Y,beforeEnter:Ft},{path:"/building",name:"BuildingMain",component:ee,beforeEnter:Ft},{path:"/building/properties",name:"BuildingProperties",component:ae,beforeEnter:Ft},{path:"/house/properties",name:"HouseProperties",component:Le,beforeEnter:Ft},{path:"/house/main",name:"HouseMain",component:rt,beforeEnter:Ft},{path:"/house/main/properties",name:"HouseMainProperties",component:nt,beforeEnter:Ft},{path:"/house/main/flats-schemas",name:"HouseMainFlatsSchemas",component:dt,beforeEnter:Ft},{path:"/house/main/chess",name:"HouseMainChess",component:ht,beforeEnter:Ft},{path:"/house/main/floors",name:"HouseMainFloors",component:_t,beforeEnter:Ft},{path:"/house/main/facades",name:"HouseMainFacades",component:bt,beforeEnter:Ft},{path:"/house/flats-schemas",name:"HouseFlatsSchemas",component:Te,beforeEnter:Ft},{path:"/house/floors",name:"HouseFloors",component:xe,beforeEnter:Ft},{path:"/house/floors/marking",name:"HouseFloorsMarking",component:we,beforeEnter:Ft},{path:"/house/chess",name:"HouseChess",component:st,beforeEnter:Ft},{path:"/house/prices",name:"HousePrices",component:Xe,beforeEnter:Ft}]});a.a.config.productionTip=!1,a.a.config.productionTip=!1,new a.a({el:"#app",router:kt,components:{App:l},template:"<App/>",store:St})},Rqa9:function(e,t){},SlCM:function(e,t){},Smr4:function(e,t){},TvdI:function(e,t){},UrBI:function(e,t){},VvEV:function(e,t){},WaQG:function(e,t){},XnBX:function(e,t){},YGWQ:function(e,t){},Yykk:function(e,t){},a3GO:function(e,t){},aF4X:function(e,t){},"av+i":function(e,t){},cBBD:function(e,t){},e5pe:function(e,t){},eCkp:function(e,t){},gWyR:function(e,t){},gw1M:function(e,t){},keWv:function(e,t){},mIZk:function(e,t){},o1yK:function(e,t){},pG3g:function(e,t){},pyqm:function(e,t){},sSMq:function(e,t){},uVed:function(e,t){},"y+6z":function(e,t){},yL8Y:function(e,t){},yNAI:function(e,t){},ySvM:function(e,t){},ygbr:function(e,t){},yh5A:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.506ebfebd9d421497945.js.map